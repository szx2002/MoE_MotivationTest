[main] 初始化加载模型...
[main] GPU 0: NVIDIA RTX A6000, total_mem=47.53 GB
[main] GPU 1: NVIDIA RTX A6000, total_mem=47.53 GB
[main] 加载模型 mistralai/Mixtral-8x7B-v0.1...
[main] 将模型基础结构移动到 GPU...

[main] 初始化后设备分配:
  model.embed_tokens.weight: cuda:0
  model.layers.0.self_attn.q_proj.weight: cuda:0
  model.layers.0.self_attn.k_proj.weight: cuda:0
  model.layers.0.self_attn.v_proj.weight: cuda:0
  model.layers.0.self_attn.o_proj.weight: cuda:0
  model.layers.0.block_sparse_moe.gate.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.0.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.0.input_layernorm.weight: cuda:0
  model.layers.0.post_attention_layernorm.weight: cuda:0
  model.layers.1.self_attn.q_proj.weight: cuda:0
  model.layers.1.self_attn.k_proj.weight: cuda:0
  model.layers.1.self_attn.v_proj.weight: cuda:0
  model.layers.1.self_attn.o_proj.weight: cuda:0
  model.layers.1.block_sparse_moe.gate.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.1.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.1.input_layernorm.weight: cuda:0
  model.layers.1.post_attention_layernorm.weight: cuda:0
  model.layers.2.self_attn.q_proj.weight: cuda:0
  model.layers.2.self_attn.k_proj.weight: cuda:0
  model.layers.2.self_attn.v_proj.weight: cuda:0
  model.layers.2.self_attn.o_proj.weight: cuda:0
  model.layers.2.block_sparse_moe.gate.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.2.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.2.input_layernorm.weight: cuda:0
  model.layers.2.post_attention_layernorm.weight: cuda:0
  model.layers.3.self_attn.q_proj.weight: cuda:0
  model.layers.3.self_attn.k_proj.weight: cuda:0
  model.layers.3.self_attn.v_proj.weight: cuda:0
  model.layers.3.self_attn.o_proj.weight: cuda:0
  model.layers.3.block_sparse_moe.gate.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.3.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.3.input_layernorm.weight: cuda:0
  model.layers.3.post_attention_layernorm.weight: cuda:0
  model.layers.4.self_attn.q_proj.weight: cuda:0
  model.layers.4.self_attn.k_proj.weight: cuda:0
  model.layers.4.self_attn.v_proj.weight: cuda:0
  model.layers.4.self_attn.o_proj.weight: cuda:0
  model.layers.4.block_sparse_moe.gate.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.4.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.4.input_layernorm.weight: cuda:0
  model.layers.4.post_attention_layernorm.weight: cuda:0
  model.layers.5.self_attn.q_proj.weight: cuda:0
  model.layers.5.self_attn.k_proj.weight: cuda:0
  model.layers.5.self_attn.v_proj.weight: cuda:0
  model.layers.5.self_attn.o_proj.weight: cuda:0
  model.layers.5.block_sparse_moe.gate.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.5.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.5.input_layernorm.weight: cuda:0
  model.layers.5.post_attention_layernorm.weight: cuda:0
  model.layers.6.self_attn.q_proj.weight: cuda:0
  model.layers.6.self_attn.k_proj.weight: cuda:0
  model.layers.6.self_attn.v_proj.weight: cuda:0
  model.layers.6.self_attn.o_proj.weight: cuda:0
  model.layers.6.block_sparse_moe.gate.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.6.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.6.input_layernorm.weight: cuda:0
  model.layers.6.post_attention_layernorm.weight: cuda:0
  model.layers.7.self_attn.q_proj.weight: cuda:0
  model.layers.7.self_attn.k_proj.weight: cuda:0
  model.layers.7.self_attn.v_proj.weight: cuda:0
  model.layers.7.self_attn.o_proj.weight: cuda:0
  model.layers.7.block_sparse_moe.gate.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.7.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.7.input_layernorm.weight: cuda:0
  model.layers.7.post_attention_layernorm.weight: cuda:0
  model.layers.8.self_attn.q_proj.weight: cuda:0
  model.layers.8.self_attn.k_proj.weight: cuda:0
  model.layers.8.self_attn.v_proj.weight: cuda:0
  model.layers.8.self_attn.o_proj.weight: cuda:0
  model.layers.8.block_sparse_moe.gate.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.8.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.8.input_layernorm.weight: cuda:0
  model.layers.8.post_attention_layernorm.weight: cuda:0
  model.layers.9.self_attn.q_proj.weight: cuda:0
  model.layers.9.self_attn.k_proj.weight: cuda:0
  model.layers.9.self_attn.v_proj.weight: cuda:0
  model.layers.9.self_attn.o_proj.weight: cuda:0
  model.layers.9.block_sparse_moe.gate.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.9.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.9.input_layernorm.weight: cuda:0
  model.layers.9.post_attention_layernorm.weight: cuda:0
  model.layers.10.self_attn.q_proj.weight: cuda:0
  model.layers.10.self_attn.k_proj.weight: cuda:0
  model.layers.10.self_attn.v_proj.weight: cuda:0
  model.layers.10.self_attn.o_proj.weight: cuda:0
  model.layers.10.block_sparse_moe.gate.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.10.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.10.input_layernorm.weight: cuda:0
  model.layers.10.post_attention_layernorm.weight: cuda:0
  model.layers.11.self_attn.q_proj.weight: cuda:0
  model.layers.11.self_attn.k_proj.weight: cuda:0
  model.layers.11.self_attn.v_proj.weight: cuda:0
  model.layers.11.self_attn.o_proj.weight: cuda:0
  model.layers.11.block_sparse_moe.gate.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.11.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.11.input_layernorm.weight: cuda:0
  model.layers.11.post_attention_layernorm.weight: cuda:0
  model.layers.12.self_attn.q_proj.weight: cuda:0
  model.layers.12.self_attn.k_proj.weight: cuda:0
  model.layers.12.self_attn.v_proj.weight: cuda:0
  model.layers.12.self_attn.o_proj.weight: cuda:0
  model.layers.12.block_sparse_moe.gate.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.12.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.12.input_layernorm.weight: cuda:0
  model.layers.12.post_attention_layernorm.weight: cuda:0
  model.layers.13.self_attn.q_proj.weight: cuda:0
  model.layers.13.self_attn.k_proj.weight: cuda:0
  model.layers.13.self_attn.v_proj.weight: cuda:0
  model.layers.13.self_attn.o_proj.weight: cuda:0
  model.layers.13.block_sparse_moe.gate.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.13.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.13.input_layernorm.weight: cuda:0
  model.layers.13.post_attention_layernorm.weight: cuda:0
  model.layers.14.self_attn.q_proj.weight: cuda:0
  model.layers.14.self_attn.k_proj.weight: cuda:0
  model.layers.14.self_attn.v_proj.weight: cuda:0
  model.layers.14.self_attn.o_proj.weight: cuda:0
  model.layers.14.block_sparse_moe.gate.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.14.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.14.input_layernorm.weight: cuda:0
  model.layers.14.post_attention_layernorm.weight: cuda:0
  model.layers.15.self_attn.q_proj.weight: cuda:0
  model.layers.15.self_attn.k_proj.weight: cuda:0
  model.layers.15.self_attn.v_proj.weight: cuda:0
  model.layers.15.self_attn.o_proj.weight: cuda:0
  model.layers.15.block_sparse_moe.gate.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.15.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.15.input_layernorm.weight: cuda:0
  model.layers.15.post_attention_layernorm.weight: cuda:0
  model.layers.16.self_attn.q_proj.weight: cuda:0
  model.layers.16.self_attn.k_proj.weight: cuda:0
  model.layers.16.self_attn.v_proj.weight: cuda:0
  model.layers.16.self_attn.o_proj.weight: cuda:0
  model.layers.16.block_sparse_moe.gate.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.16.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.16.input_layernorm.weight: cuda:0
  model.layers.16.post_attention_layernorm.weight: cuda:0
  model.layers.17.self_attn.q_proj.weight: cuda:0
  model.layers.17.self_attn.k_proj.weight: cuda:0
  model.layers.17.self_attn.v_proj.weight: cuda:0
  model.layers.17.self_attn.o_proj.weight: cuda:0
  model.layers.17.block_sparse_moe.gate.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.17.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.17.input_layernorm.weight: cuda:0
  model.layers.17.post_attention_layernorm.weight: cuda:0
  model.layers.18.self_attn.q_proj.weight: cuda:0
  model.layers.18.self_attn.k_proj.weight: cuda:0
  model.layers.18.self_attn.v_proj.weight: cuda:0
  model.layers.18.self_attn.o_proj.weight: cuda:0
  model.layers.18.block_sparse_moe.gate.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.18.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.18.input_layernorm.weight: cuda:0
  model.layers.18.post_attention_layernorm.weight: cuda:0
  model.layers.19.self_attn.q_proj.weight: cuda:0
  model.layers.19.self_attn.k_proj.weight: cuda:0
  model.layers.19.self_attn.v_proj.weight: cuda:0
  model.layers.19.self_attn.o_proj.weight: cuda:0
  model.layers.19.block_sparse_moe.gate.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.19.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.19.input_layernorm.weight: cuda:0
  model.layers.19.post_attention_layernorm.weight: cuda:0
  model.layers.20.self_attn.q_proj.weight: cuda:0
  model.layers.20.self_attn.k_proj.weight: cuda:0
  model.layers.20.self_attn.v_proj.weight: cuda:0
  model.layers.20.self_attn.o_proj.weight: cuda:0
  model.layers.20.block_sparse_moe.gate.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.20.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.20.input_layernorm.weight: cuda:0
  model.layers.20.post_attention_layernorm.weight: cuda:0
  model.layers.21.self_attn.q_proj.weight: cuda:0
  model.layers.21.self_attn.k_proj.weight: cuda:0
  model.layers.21.self_attn.v_proj.weight: cuda:0
  model.layers.21.self_attn.o_proj.weight: cuda:0
  model.layers.21.block_sparse_moe.gate.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.21.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.21.input_layernorm.weight: cuda:0
  model.layers.21.post_attention_layernorm.weight: cuda:0
  model.layers.22.self_attn.q_proj.weight: cuda:0
  model.layers.22.self_attn.k_proj.weight: cuda:0
  model.layers.22.self_attn.v_proj.weight: cuda:0
  model.layers.22.self_attn.o_proj.weight: cuda:0
  model.layers.22.block_sparse_moe.gate.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.22.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.22.input_layernorm.weight: cuda:0
  model.layers.22.post_attention_layernorm.weight: cuda:0
  model.layers.23.self_attn.q_proj.weight: cuda:0
  model.layers.23.self_attn.k_proj.weight: cuda:0
  model.layers.23.self_attn.v_proj.weight: cuda:0
  model.layers.23.self_attn.o_proj.weight: cuda:0
  model.layers.23.block_sparse_moe.gate.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.23.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.23.input_layernorm.weight: cuda:0
  model.layers.23.post_attention_layernorm.weight: cuda:0
  model.layers.24.self_attn.q_proj.weight: cuda:0
  model.layers.24.self_attn.k_proj.weight: cuda:0
  model.layers.24.self_attn.v_proj.weight: cuda:0
  model.layers.24.self_attn.o_proj.weight: cuda:0
  model.layers.24.block_sparse_moe.gate.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.24.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.24.input_layernorm.weight: cuda:0
  model.layers.24.post_attention_layernorm.weight: cuda:0
  model.layers.25.self_attn.q_proj.weight: cuda:0
  model.layers.25.self_attn.k_proj.weight: cuda:0
  model.layers.25.self_attn.v_proj.weight: cuda:0
  model.layers.25.self_attn.o_proj.weight: cuda:0
  model.layers.25.block_sparse_moe.gate.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.25.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.25.input_layernorm.weight: cuda:0
  model.layers.25.post_attention_layernorm.weight: cuda:0
  model.layers.26.self_attn.q_proj.weight: cuda:0
  model.layers.26.self_attn.k_proj.weight: cuda:0
  model.layers.26.self_attn.v_proj.weight: cuda:0
  model.layers.26.self_attn.o_proj.weight: cuda:0
  model.layers.26.block_sparse_moe.gate.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.26.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.26.input_layernorm.weight: cuda:0
  model.layers.26.post_attention_layernorm.weight: cuda:0
  model.layers.27.self_attn.q_proj.weight: cuda:0
  model.layers.27.self_attn.k_proj.weight: cuda:0
  model.layers.27.self_attn.v_proj.weight: cuda:0
  model.layers.27.self_attn.o_proj.weight: cuda:0
  model.layers.27.block_sparse_moe.gate.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.27.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.27.input_layernorm.weight: cuda:0
  model.layers.27.post_attention_layernorm.weight: cuda:0
  model.layers.28.self_attn.q_proj.weight: cuda:0
  model.layers.28.self_attn.k_proj.weight: cuda:0
  model.layers.28.self_attn.v_proj.weight: cuda:0
  model.layers.28.self_attn.o_proj.weight: cuda:0
  model.layers.28.block_sparse_moe.gate.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.28.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.28.input_layernorm.weight: cuda:0
  model.layers.28.post_attention_layernorm.weight: cuda:0
  model.layers.29.self_attn.q_proj.weight: cuda:0
  model.layers.29.self_attn.k_proj.weight: cuda:0
  model.layers.29.self_attn.v_proj.weight: cuda:0
  model.layers.29.self_attn.o_proj.weight: cuda:0
  model.layers.29.block_sparse_moe.gate.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.29.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.29.input_layernorm.weight: cuda:0
  model.layers.29.post_attention_layernorm.weight: cuda:0
  model.layers.30.self_attn.q_proj.weight: cuda:0
  model.layers.30.self_attn.k_proj.weight: cuda:0
  model.layers.30.self_attn.v_proj.weight: cuda:0
  model.layers.30.self_attn.o_proj.weight: cuda:0
  model.layers.30.block_sparse_moe.gate.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.30.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.30.input_layernorm.weight: cuda:0
  model.layers.30.post_attention_layernorm.weight: cuda:0
  model.layers.31.self_attn.q_proj.weight: cuda:0
  model.layers.31.self_attn.k_proj.weight: cuda:0
  model.layers.31.self_attn.v_proj.weight: cuda:0
  model.layers.31.self_attn.o_proj.weight: cuda:0
  model.layers.31.block_sparse_moe.gate.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.0.w1.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.0.w2.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.0.w3.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.1.w1.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.1.w2.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.1.w3.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.2.w1.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.2.w2.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.2.w3.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.3.w1.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.3.w2.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.3.w3.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.4.w1.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.4.w2.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.4.w3.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.5.w1.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.5.w2.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.5.w3.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.6.w1.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.6.w2.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.6.w3.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.7.w1.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.7.w2.weight: cuda:0
  model.layers.31.block_sparse_moe.experts.7.w3.weight: cuda:0
  model.layers.31.input_layernorm.weight: cuda:0
  model.layers.31.post_attention_layernorm.weight: cuda:0
  model.norm.weight: cuda:0
  lm_head.weight: cuda:0

[main] 模型子模块:
  
  model
  model.embed_tokens
  model.layers
  model.layers.0
  model.layers.0.self_attn
  model.layers.0.self_attn.q_proj
  model.layers.0.self_attn.k_proj
  model.layers.0.self_attn.v_proj
  model.layers.0.self_attn.o_proj
  model.layers.0.self_attn.rotary_emb
  model.layers.0.block_sparse_moe
  model.layers.0.block_sparse_moe.gate
  model.layers.0.block_sparse_moe.experts
  model.layers.0.block_sparse_moe.experts.0
  model.layers.0.block_sparse_moe.experts.0.w1
  model.layers.0.block_sparse_moe.experts.0.w2
  model.layers.0.block_sparse_moe.experts.0.w3
  model.layers.0.block_sparse_moe.experts.0.act_fn
  model.layers.0.block_sparse_moe.experts.1
  model.layers.0.block_sparse_moe.experts.1.w1
  model.layers.0.block_sparse_moe.experts.1.w2
  model.layers.0.block_sparse_moe.experts.1.w3
  model.layers.0.block_sparse_moe.experts.1.act_fn
  model.layers.0.block_sparse_moe.experts.2
  model.layers.0.block_sparse_moe.experts.2.w1
  model.layers.0.block_sparse_moe.experts.2.w2
  model.layers.0.block_sparse_moe.experts.2.w3
  model.layers.0.block_sparse_moe.experts.2.act_fn
  model.layers.0.block_sparse_moe.experts.3
  model.layers.0.block_sparse_moe.experts.3.w1
  model.layers.0.block_sparse_moe.experts.3.w2
  model.layers.0.block_sparse_moe.experts.3.w3
  model.layers.0.block_sparse_moe.experts.3.act_fn
  model.layers.0.block_sparse_moe.experts.4
  model.layers.0.block_sparse_moe.experts.4.w1
  model.layers.0.block_sparse_moe.experts.4.w2
  model.layers.0.block_sparse_moe.experts.4.w3
  model.layers.0.block_sparse_moe.experts.4.act_fn
  model.layers.0.block_sparse_moe.experts.5
  model.layers.0.block_sparse_moe.experts.5.w1
  model.layers.0.block_sparse_moe.experts.5.w2
  model.layers.0.block_sparse_moe.experts.5.w3
  model.layers.0.block_sparse_moe.experts.5.act_fn
  model.layers.0.block_sparse_moe.experts.6
  model.layers.0.block_sparse_moe.experts.6.w1
  model.layers.0.block_sparse_moe.experts.6.w2
  model.layers.0.block_sparse_moe.experts.6.w3
  model.layers.0.block_sparse_moe.experts.6.act_fn
  model.layers.0.block_sparse_moe.experts.7
  model.layers.0.block_sparse_moe.experts.7.w1
  model.layers.0.block_sparse_moe.experts.7.w2
  model.layers.0.block_sparse_moe.experts.7.w3
  model.layers.0.block_sparse_moe.experts.7.act_fn
  model.layers.0.input_layernorm
  model.layers.0.post_attention_layernorm
  model.layers.1
  model.layers.1.self_attn
  model.layers.1.self_attn.q_proj
  model.layers.1.self_attn.k_proj
  model.layers.1.self_attn.v_proj
  model.layers.1.self_attn.o_proj
  model.layers.1.self_attn.rotary_emb
  model.layers.1.block_sparse_moe
  model.layers.1.block_sparse_moe.gate
  model.layers.1.block_sparse_moe.experts
  model.layers.1.block_sparse_moe.experts.0
  model.layers.1.block_sparse_moe.experts.0.w1
  model.layers.1.block_sparse_moe.experts.0.w2
  model.layers.1.block_sparse_moe.experts.0.w3
  model.layers.1.block_sparse_moe.experts.0.act_fn
  model.layers.1.block_sparse_moe.experts.1
  model.layers.1.block_sparse_moe.experts.1.w1
  model.layers.1.block_sparse_moe.experts.1.w2
  model.layers.1.block_sparse_moe.experts.1.w3
  model.layers.1.block_sparse_moe.experts.1.act_fn
  model.layers.1.block_sparse_moe.experts.2
  model.layers.1.block_sparse_moe.experts.2.w1
  model.layers.1.block_sparse_moe.experts.2.w2
  model.layers.1.block_sparse_moe.experts.2.w3
  model.layers.1.block_sparse_moe.experts.2.act_fn
  model.layers.1.block_sparse_moe.experts.3
  model.layers.1.block_sparse_moe.experts.3.w1
  model.layers.1.block_sparse_moe.experts.3.w2
  model.layers.1.block_sparse_moe.experts.3.w3
  model.layers.1.block_sparse_moe.experts.3.act_fn
  model.layers.1.block_sparse_moe.experts.4
  model.layers.1.block_sparse_moe.experts.4.w1
  model.layers.1.block_sparse_moe.experts.4.w2
  model.layers.1.block_sparse_moe.experts.4.w3
  model.layers.1.block_sparse_moe.experts.4.act_fn
  model.layers.1.block_sparse_moe.experts.5
  model.layers.1.block_sparse_moe.experts.5.w1
  model.layers.1.block_sparse_moe.experts.5.w2
  model.layers.1.block_sparse_moe.experts.5.w3
  model.layers.1.block_sparse_moe.experts.5.act_fn
  model.layers.1.block_sparse_moe.experts.6
  model.layers.1.block_sparse_moe.experts.6.w1
  model.layers.1.block_sparse_moe.experts.6.w2
  model.layers.1.block_sparse_moe.experts.6.w3
  model.layers.1.block_sparse_moe.experts.6.act_fn
  model.layers.1.block_sparse_moe.experts.7
  model.layers.1.block_sparse_moe.experts.7.w1
  model.layers.1.block_sparse_moe.experts.7.w2
  model.layers.1.block_sparse_moe.experts.7.w3
  model.layers.1.block_sparse_moe.experts.7.act_fn
  model.layers.1.input_layernorm
  model.layers.1.post_attention_layernorm
  model.layers.2
  model.layers.2.self_attn
  model.layers.2.self_attn.q_proj
  model.layers.2.self_attn.k_proj
  model.layers.2.self_attn.v_proj
  model.layers.2.self_attn.o_proj
  model.layers.2.self_attn.rotary_emb
  model.layers.2.block_sparse_moe
  model.layers.2.block_sparse_moe.gate
  model.layers.2.block_sparse_moe.experts
  model.layers.2.block_sparse_moe.experts.0
  model.layers.2.block_sparse_moe.experts.0.w1
  model.layers.2.block_sparse_moe.experts.0.w2
  model.layers.2.block_sparse_moe.experts.0.w3
  model.layers.2.block_sparse_moe.experts.0.act_fn
  model.layers.2.block_sparse_moe.experts.1
  model.layers.2.block_sparse_moe.experts.1.w1
  model.layers.2.block_sparse_moe.experts.1.w2
  model.layers.2.block_sparse_moe.experts.1.w3
  model.layers.2.block_sparse_moe.experts.1.act_fn
  model.layers.2.block_sparse_moe.experts.2
  model.layers.2.block_sparse_moe.experts.2.w1
  model.layers.2.block_sparse_moe.experts.2.w2
  model.layers.2.block_sparse_moe.experts.2.w3
  model.layers.2.block_sparse_moe.experts.2.act_fn
  model.layers.2.block_sparse_moe.experts.3
  model.layers.2.block_sparse_moe.experts.3.w1
  model.layers.2.block_sparse_moe.experts.3.w2
  model.layers.2.block_sparse_moe.experts.3.w3
  model.layers.2.block_sparse_moe.experts.3.act_fn
  model.layers.2.block_sparse_moe.experts.4
  model.layers.2.block_sparse_moe.experts.4.w1
  model.layers.2.block_sparse_moe.experts.4.w2
  model.layers.2.block_sparse_moe.experts.4.w3
  model.layers.2.block_sparse_moe.experts.4.act_fn
  model.layers.2.block_sparse_moe.experts.5
  model.layers.2.block_sparse_moe.experts.5.w1
  model.layers.2.block_sparse_moe.experts.5.w2
  model.layers.2.block_sparse_moe.experts.5.w3
  model.layers.2.block_sparse_moe.experts.5.act_fn
  model.layers.2.block_sparse_moe.experts.6
  model.layers.2.block_sparse_moe.experts.6.w1
  model.layers.2.block_sparse_moe.experts.6.w2
  model.layers.2.block_sparse_moe.experts.6.w3
  model.layers.2.block_sparse_moe.experts.6.act_fn
  model.layers.2.block_sparse_moe.experts.7
  model.layers.2.block_sparse_moe.experts.7.w1
  model.layers.2.block_sparse_moe.experts.7.w2
  model.layers.2.block_sparse_moe.experts.7.w3
  model.layers.2.block_sparse_moe.experts.7.act_fn
  model.layers.2.input_layernorm
  model.layers.2.post_attention_layernorm
  model.layers.3
  model.layers.3.self_attn
  model.layers.3.self_attn.q_proj
  model.layers.3.self_attn.k_proj
  model.layers.3.self_attn.v_proj
  model.layers.3.self_attn.o_proj
  model.layers.3.self_attn.rotary_emb
  model.layers.3.block_sparse_moe
  model.layers.3.block_sparse_moe.gate
  model.layers.3.block_sparse_moe.experts
  model.layers.3.block_sparse_moe.experts.0
  model.layers.3.block_sparse_moe.experts.0.w1
  model.layers.3.block_sparse_moe.experts.0.w2
  model.layers.3.block_sparse_moe.experts.0.w3
  model.layers.3.block_sparse_moe.experts.0.act_fn
  model.layers.3.block_sparse_moe.experts.1
  model.layers.3.block_sparse_moe.experts.1.w1
  model.layers.3.block_sparse_moe.experts.1.w2
  model.layers.3.block_sparse_moe.experts.1.w3
  model.layers.3.block_sparse_moe.experts.1.act_fn
  model.layers.3.block_sparse_moe.experts.2
  model.layers.3.block_sparse_moe.experts.2.w1
  model.layers.3.block_sparse_moe.experts.2.w2
  model.layers.3.block_sparse_moe.experts.2.w3
  model.layers.3.block_sparse_moe.experts.2.act_fn
  model.layers.3.block_sparse_moe.experts.3
  model.layers.3.block_sparse_moe.experts.3.w1
  model.layers.3.block_sparse_moe.experts.3.w2
  model.layers.3.block_sparse_moe.experts.3.w3
  model.layers.3.block_sparse_moe.experts.3.act_fn
  model.layers.3.block_sparse_moe.experts.4
  model.layers.3.block_sparse_moe.experts.4.w1
  model.layers.3.block_sparse_moe.experts.4.w2
  model.layers.3.block_sparse_moe.experts.4.w3
  model.layers.3.block_sparse_moe.experts.4.act_fn
  model.layers.3.block_sparse_moe.experts.5
  model.layers.3.block_sparse_moe.experts.5.w1
  model.layers.3.block_sparse_moe.experts.5.w2
  model.layers.3.block_sparse_moe.experts.5.w3
  model.layers.3.block_sparse_moe.experts.5.act_fn
  model.layers.3.block_sparse_moe.experts.6
  model.layers.3.block_sparse_moe.experts.6.w1
  model.layers.3.block_sparse_moe.experts.6.w2
  model.layers.3.block_sparse_moe.experts.6.w3
  model.layers.3.block_sparse_moe.experts.6.act_fn
  model.layers.3.block_sparse_moe.experts.7
  model.layers.3.block_sparse_moe.experts.7.w1
  model.layers.3.block_sparse_moe.experts.7.w2
  model.layers.3.block_sparse_moe.experts.7.w3
  model.layers.3.block_sparse_moe.experts.7.act_fn
  model.layers.3.input_layernorm
  model.layers.3.post_attention_layernorm
  model.layers.4
  model.layers.4.self_attn
  model.layers.4.self_attn.q_proj
  model.layers.4.self_attn.k_proj
  model.layers.4.self_attn.v_proj
  model.layers.4.self_attn.o_proj
  model.layers.4.self_attn.rotary_emb
  model.layers.4.block_sparse_moe
  model.layers.4.block_sparse_moe.gate
  model.layers.4.block_sparse_moe.experts
  model.layers.4.block_sparse_moe.experts.0
  model.layers.4.block_sparse_moe.experts.0.w1
  model.layers.4.block_sparse_moe.experts.0.w2
  model.layers.4.block_sparse_moe.experts.0.w3
  model.layers.4.block_sparse_moe.experts.0.act_fn
  model.layers.4.block_sparse_moe.experts.1
  model.layers.4.block_sparse_moe.experts.1.w1
  model.layers.4.block_sparse_moe.experts.1.w2
  model.layers.4.block_sparse_moe.experts.1.w3
  model.layers.4.block_sparse_moe.experts.1.act_fn
  model.layers.4.block_sparse_moe.experts.2
  model.layers.4.block_sparse_moe.experts.2.w1
  model.layers.4.block_sparse_moe.experts.2.w2
  model.layers.4.block_sparse_moe.experts.2.w3
  model.layers.4.block_sparse_moe.experts.2.act_fn
  model.layers.4.block_sparse_moe.experts.3
  model.layers.4.block_sparse_moe.experts.3.w1
  model.layers.4.block_sparse_moe.experts.3.w2
  model.layers.4.block_sparse_moe.experts.3.w3
  model.layers.4.block_sparse_moe.experts.3.act_fn
  model.layers.4.block_sparse_moe.experts.4
  model.layers.4.block_sparse_moe.experts.4.w1
  model.layers.4.block_sparse_moe.experts.4.w2
  model.layers.4.block_sparse_moe.experts.4.w3
  model.layers.4.block_sparse_moe.experts.4.act_fn
  model.layers.4.block_sparse_moe.experts.5
  model.layers.4.block_sparse_moe.experts.5.w1
  model.layers.4.block_sparse_moe.experts.5.w2
  model.layers.4.block_sparse_moe.experts.5.w3
  model.layers.4.block_sparse_moe.experts.5.act_fn
  model.layers.4.block_sparse_moe.experts.6
  model.layers.4.block_sparse_moe.experts.6.w1
  model.layers.4.block_sparse_moe.experts.6.w2
  model.layers.4.block_sparse_moe.experts.6.w3
  model.layers.4.block_sparse_moe.experts.6.act_fn
  model.layers.4.block_sparse_moe.experts.7
  model.layers.4.block_sparse_moe.experts.7.w1
  model.layers.4.block_sparse_moe.experts.7.w2
  model.layers.4.block_sparse_moe.experts.7.w3
  model.layers.4.block_sparse_moe.experts.7.act_fn
  model.layers.4.input_layernorm
  model.layers.4.post_attention_layernorm
  model.layers.5
  model.layers.5.self_attn
  model.layers.5.self_attn.q_proj
  model.layers.5.self_attn.k_proj
  model.layers.5.self_attn.v_proj
  model.layers.5.self_attn.o_proj
  model.layers.5.self_attn.rotary_emb
  model.layers.5.block_sparse_moe
  model.layers.5.block_sparse_moe.gate
  model.layers.5.block_sparse_moe.experts
  model.layers.5.block_sparse_moe.experts.0
  model.layers.5.block_sparse_moe.experts.0.w1
  model.layers.5.block_sparse_moe.experts.0.w2
  model.layers.5.block_sparse_moe.experts.0.w3
  model.layers.5.block_sparse_moe.experts.0.act_fn
  model.layers.5.block_sparse_moe.experts.1
  model.layers.5.block_sparse_moe.experts.1.w1
  model.layers.5.block_sparse_moe.experts.1.w2
  model.layers.5.block_sparse_moe.experts.1.w3
  model.layers.5.block_sparse_moe.experts.1.act_fn
  model.layers.5.block_sparse_moe.experts.2
  model.layers.5.block_sparse_moe.experts.2.w1
  model.layers.5.block_sparse_moe.experts.2.w2
  model.layers.5.block_sparse_moe.experts.2.w3
  model.layers.5.block_sparse_moe.experts.2.act_fn
  model.layers.5.block_sparse_moe.experts.3
  model.layers.5.block_sparse_moe.experts.3.w1
  model.layers.5.block_sparse_moe.experts.3.w2
  model.layers.5.block_sparse_moe.experts.3.w3
  model.layers.5.block_sparse_moe.experts.3.act_fn
  model.layers.5.block_sparse_moe.experts.4
  model.layers.5.block_sparse_moe.experts.4.w1
  model.layers.5.block_sparse_moe.experts.4.w2
  model.layers.5.block_sparse_moe.experts.4.w3
  model.layers.5.block_sparse_moe.experts.4.act_fn
  model.layers.5.block_sparse_moe.experts.5
  model.layers.5.block_sparse_moe.experts.5.w1
  model.layers.5.block_sparse_moe.experts.5.w2
  model.layers.5.block_sparse_moe.experts.5.w3
  model.layers.5.block_sparse_moe.experts.5.act_fn
  model.layers.5.block_sparse_moe.experts.6
  model.layers.5.block_sparse_moe.experts.6.w1
  model.layers.5.block_sparse_moe.experts.6.w2
  model.layers.5.block_sparse_moe.experts.6.w3
  model.layers.5.block_sparse_moe.experts.6.act_fn
  model.layers.5.block_sparse_moe.experts.7
  model.layers.5.block_sparse_moe.experts.7.w1
  model.layers.5.block_sparse_moe.experts.7.w2
  model.layers.5.block_sparse_moe.experts.7.w3
  model.layers.5.block_sparse_moe.experts.7.act_fn
  model.layers.5.input_layernorm
  model.layers.5.post_attention_layernorm
  model.layers.6
  model.layers.6.self_attn
  model.layers.6.self_attn.q_proj
  model.layers.6.self_attn.k_proj
  model.layers.6.self_attn.v_proj
  model.layers.6.self_attn.o_proj
  model.layers.6.self_attn.rotary_emb
  model.layers.6.block_sparse_moe
  model.layers.6.block_sparse_moe.gate
  model.layers.6.block_sparse_moe.experts
  model.layers.6.block_sparse_moe.experts.0
  model.layers.6.block_sparse_moe.experts.0.w1
  model.layers.6.block_sparse_moe.experts.0.w2
  model.layers.6.block_sparse_moe.experts.0.w3
  model.layers.6.block_sparse_moe.experts.0.act_fn
  model.layers.6.block_sparse_moe.experts.1
  model.layers.6.block_sparse_moe.experts.1.w1
  model.layers.6.block_sparse_moe.experts.1.w2
  model.layers.6.block_sparse_moe.experts.1.w3
  model.layers.6.block_sparse_moe.experts.1.act_fn
  model.layers.6.block_sparse_moe.experts.2
  model.layers.6.block_sparse_moe.experts.2.w1
  model.layers.6.block_sparse_moe.experts.2.w2
  model.layers.6.block_sparse_moe.experts.2.w3
  model.layers.6.block_sparse_moe.experts.2.act_fn
  model.layers.6.block_sparse_moe.experts.3
  model.layers.6.block_sparse_moe.experts.3.w1
  model.layers.6.block_sparse_moe.experts.3.w2
  model.layers.6.block_sparse_moe.experts.3.w3
  model.layers.6.block_sparse_moe.experts.3.act_fn
  model.layers.6.block_sparse_moe.experts.4
  model.layers.6.block_sparse_moe.experts.4.w1
  model.layers.6.block_sparse_moe.experts.4.w2
  model.layers.6.block_sparse_moe.experts.4.w3
  model.layers.6.block_sparse_moe.experts.4.act_fn
  model.layers.6.block_sparse_moe.experts.5
  model.layers.6.block_sparse_moe.experts.5.w1
  model.layers.6.block_sparse_moe.experts.5.w2
  model.layers.6.block_sparse_moe.experts.5.w3
  model.layers.6.block_sparse_moe.experts.5.act_fn
  model.layers.6.block_sparse_moe.experts.6
  model.layers.6.block_sparse_moe.experts.6.w1
  model.layers.6.block_sparse_moe.experts.6.w2
  model.layers.6.block_sparse_moe.experts.6.w3
  model.layers.6.block_sparse_moe.experts.6.act_fn
  model.layers.6.block_sparse_moe.experts.7
  model.layers.6.block_sparse_moe.experts.7.w1
  model.layers.6.block_sparse_moe.experts.7.w2
  model.layers.6.block_sparse_moe.experts.7.w3
  model.layers.6.block_sparse_moe.experts.7.act_fn
  model.layers.6.input_layernorm
  model.layers.6.post_attention_layernorm
  model.layers.7
  model.layers.7.self_attn
  model.layers.7.self_attn.q_proj
  model.layers.7.self_attn.k_proj
  model.layers.7.self_attn.v_proj
  model.layers.7.self_attn.o_proj
  model.layers.7.self_attn.rotary_emb
  model.layers.7.block_sparse_moe
  model.layers.7.block_sparse_moe.gate
  model.layers.7.block_sparse_moe.experts
  model.layers.7.block_sparse_moe.experts.0
  model.layers.7.block_sparse_moe.experts.0.w1
  model.layers.7.block_sparse_moe.experts.0.w2
  model.layers.7.block_sparse_moe.experts.0.w3
  model.layers.7.block_sparse_moe.experts.0.act_fn
  model.layers.7.block_sparse_moe.experts.1
  model.layers.7.block_sparse_moe.experts.1.w1
  model.layers.7.block_sparse_moe.experts.1.w2
  model.layers.7.block_sparse_moe.experts.1.w3
  model.layers.7.block_sparse_moe.experts.1.act_fn
  model.layers.7.block_sparse_moe.experts.2
  model.layers.7.block_sparse_moe.experts.2.w1
  model.layers.7.block_sparse_moe.experts.2.w2
  model.layers.7.block_sparse_moe.experts.2.w3
  model.layers.7.block_sparse_moe.experts.2.act_fn
  model.layers.7.block_sparse_moe.experts.3
  model.layers.7.block_sparse_moe.experts.3.w1
  model.layers.7.block_sparse_moe.experts.3.w2
  model.layers.7.block_sparse_moe.experts.3.w3
  model.layers.7.block_sparse_moe.experts.3.act_fn
  model.layers.7.block_sparse_moe.experts.4
  model.layers.7.block_sparse_moe.experts.4.w1
  model.layers.7.block_sparse_moe.experts.4.w2
  model.layers.7.block_sparse_moe.experts.4.w3
  model.layers.7.block_sparse_moe.experts.4.act_fn
  model.layers.7.block_sparse_moe.experts.5
  model.layers.7.block_sparse_moe.experts.5.w1
  model.layers.7.block_sparse_moe.experts.5.w2
  model.layers.7.block_sparse_moe.experts.5.w3
  model.layers.7.block_sparse_moe.experts.5.act_fn
  model.layers.7.block_sparse_moe.experts.6
  model.layers.7.block_sparse_moe.experts.6.w1
  model.layers.7.block_sparse_moe.experts.6.w2
  model.layers.7.block_sparse_moe.experts.6.w3
  model.layers.7.block_sparse_moe.experts.6.act_fn
  model.layers.7.block_sparse_moe.experts.7
  model.layers.7.block_sparse_moe.experts.7.w1
  model.layers.7.block_sparse_moe.experts.7.w2
  model.layers.7.block_sparse_moe.experts.7.w3
  model.layers.7.block_sparse_moe.experts.7.act_fn
  model.layers.7.input_layernorm
  model.layers.7.post_attention_layernorm
  model.layers.8
  model.layers.8.self_attn
  model.layers.8.self_attn.q_proj
  model.layers.8.self_attn.k_proj
  model.layers.8.self_attn.v_proj
  model.layers.8.self_attn.o_proj
  model.layers.8.self_attn.rotary_emb
  model.layers.8.block_sparse_moe
  model.layers.8.block_sparse_moe.gate
  model.layers.8.block_sparse_moe.experts
  model.layers.8.block_sparse_moe.experts.0
  model.layers.8.block_sparse_moe.experts.0.w1
  model.layers.8.block_sparse_moe.experts.0.w2
  model.layers.8.block_sparse_moe.experts.0.w3
  model.layers.8.block_sparse_moe.experts.0.act_fn
  model.layers.8.block_sparse_moe.experts.1
  model.layers.8.block_sparse_moe.experts.1.w1
  model.layers.8.block_sparse_moe.experts.1.w2
  model.layers.8.block_sparse_moe.experts.1.w3
  model.layers.8.block_sparse_moe.experts.1.act_fn
  model.layers.8.block_sparse_moe.experts.2
  model.layers.8.block_sparse_moe.experts.2.w1
  model.layers.8.block_sparse_moe.experts.2.w2
  model.layers.8.block_sparse_moe.experts.2.w3
  model.layers.8.block_sparse_moe.experts.2.act_fn
  model.layers.8.block_sparse_moe.experts.3
  model.layers.8.block_sparse_moe.experts.3.w1
  model.layers.8.block_sparse_moe.experts.3.w2
  model.layers.8.block_sparse_moe.experts.3.w3
  model.layers.8.block_sparse_moe.experts.3.act_fn
  model.layers.8.block_sparse_moe.experts.4
  model.layers.8.block_sparse_moe.experts.4.w1
  model.layers.8.block_sparse_moe.experts.4.w2
  model.layers.8.block_sparse_moe.experts.4.w3
  model.layers.8.block_sparse_moe.experts.4.act_fn
  model.layers.8.block_sparse_moe.experts.5
  model.layers.8.block_sparse_moe.experts.5.w1
  model.layers.8.block_sparse_moe.experts.5.w2
  model.layers.8.block_sparse_moe.experts.5.w3
  model.layers.8.block_sparse_moe.experts.5.act_fn
  model.layers.8.block_sparse_moe.experts.6
  model.layers.8.block_sparse_moe.experts.6.w1
  model.layers.8.block_sparse_moe.experts.6.w2
  model.layers.8.block_sparse_moe.experts.6.w3
  model.layers.8.block_sparse_moe.experts.6.act_fn
  model.layers.8.block_sparse_moe.experts.7
  model.layers.8.block_sparse_moe.experts.7.w1
  model.layers.8.block_sparse_moe.experts.7.w2
  model.layers.8.block_sparse_moe.experts.7.w3
  model.layers.8.block_sparse_moe.experts.7.act_fn
  model.layers.8.input_layernorm
  model.layers.8.post_attention_layernorm
  model.layers.9
  model.layers.9.self_attn
  model.layers.9.self_attn.q_proj
  model.layers.9.self_attn.k_proj
  model.layers.9.self_attn.v_proj
  model.layers.9.self_attn.o_proj
  model.layers.9.self_attn.rotary_emb
  model.layers.9.block_sparse_moe
  model.layers.9.block_sparse_moe.gate
  model.layers.9.block_sparse_moe.experts
  model.layers.9.block_sparse_moe.experts.0
  model.layers.9.block_sparse_moe.experts.0.w1
  model.layers.9.block_sparse_moe.experts.0.w2
  model.layers.9.block_sparse_moe.experts.0.w3
  model.layers.9.block_sparse_moe.experts.0.act_fn
  model.layers.9.block_sparse_moe.experts.1
  model.layers.9.block_sparse_moe.experts.1.w1
  model.layers.9.block_sparse_moe.experts.1.w2
  model.layers.9.block_sparse_moe.experts.1.w3
  model.layers.9.block_sparse_moe.experts.1.act_fn
  model.layers.9.block_sparse_moe.experts.2
  model.layers.9.block_sparse_moe.experts.2.w1
  model.layers.9.block_sparse_moe.experts.2.w2
  model.layers.9.block_sparse_moe.experts.2.w3
  model.layers.9.block_sparse_moe.experts.2.act_fn
  model.layers.9.block_sparse_moe.experts.3
  model.layers.9.block_sparse_moe.experts.3.w1
  model.layers.9.block_sparse_moe.experts.3.w2
  model.layers.9.block_sparse_moe.experts.3.w3
  model.layers.9.block_sparse_moe.experts.3.act_fn
  model.layers.9.block_sparse_moe.experts.4
  model.layers.9.block_sparse_moe.experts.4.w1
  model.layers.9.block_sparse_moe.experts.4.w2
  model.layers.9.block_sparse_moe.experts.4.w3
  model.layers.9.block_sparse_moe.experts.4.act_fn
  model.layers.9.block_sparse_moe.experts.5
  model.layers.9.block_sparse_moe.experts.5.w1
  model.layers.9.block_sparse_moe.experts.5.w2
  model.layers.9.block_sparse_moe.experts.5.w3
  model.layers.9.block_sparse_moe.experts.5.act_fn
  model.layers.9.block_sparse_moe.experts.6
  model.layers.9.block_sparse_moe.experts.6.w1
  model.layers.9.block_sparse_moe.experts.6.w2
  model.layers.9.block_sparse_moe.experts.6.w3
  model.layers.9.block_sparse_moe.experts.6.act_fn
  model.layers.9.block_sparse_moe.experts.7
  model.layers.9.block_sparse_moe.experts.7.w1
  model.layers.9.block_sparse_moe.experts.7.w2
  model.layers.9.block_sparse_moe.experts.7.w3
  model.layers.9.block_sparse_moe.experts.7.act_fn
  model.layers.9.input_layernorm
  model.layers.9.post_attention_layernorm
  model.layers.10
  model.layers.10.self_attn
  model.layers.10.self_attn.q_proj
  model.layers.10.self_attn.k_proj
  model.layers.10.self_attn.v_proj
  model.layers.10.self_attn.o_proj
  model.layers.10.self_attn.rotary_emb
  model.layers.10.block_sparse_moe
  model.layers.10.block_sparse_moe.gate
  model.layers.10.block_sparse_moe.experts
  model.layers.10.block_sparse_moe.experts.0
  model.layers.10.block_sparse_moe.experts.0.w1
  model.layers.10.block_sparse_moe.experts.0.w2
  model.layers.10.block_sparse_moe.experts.0.w3
  model.layers.10.block_sparse_moe.experts.0.act_fn
  model.layers.10.block_sparse_moe.experts.1
  model.layers.10.block_sparse_moe.experts.1.w1
  model.layers.10.block_sparse_moe.experts.1.w2
  model.layers.10.block_sparse_moe.experts.1.w3
  model.layers.10.block_sparse_moe.experts.1.act_fn
  model.layers.10.block_sparse_moe.experts.2
  model.layers.10.block_sparse_moe.experts.2.w1
  model.layers.10.block_sparse_moe.experts.2.w2
  model.layers.10.block_sparse_moe.experts.2.w3
  model.layers.10.block_sparse_moe.experts.2.act_fn
  model.layers.10.block_sparse_moe.experts.3
  model.layers.10.block_sparse_moe.experts.3.w1
  model.layers.10.block_sparse_moe.experts.3.w2
  model.layers.10.block_sparse_moe.experts.3.w3
  model.layers.10.block_sparse_moe.experts.3.act_fn
  model.layers.10.block_sparse_moe.experts.4
  model.layers.10.block_sparse_moe.experts.4.w1
  model.layers.10.block_sparse_moe.experts.4.w2
  model.layers.10.block_sparse_moe.experts.4.w3
  model.layers.10.block_sparse_moe.experts.4.act_fn
  model.layers.10.block_sparse_moe.experts.5
  model.layers.10.block_sparse_moe.experts.5.w1
  model.layers.10.block_sparse_moe.experts.5.w2
  model.layers.10.block_sparse_moe.experts.5.w3
  model.layers.10.block_sparse_moe.experts.5.act_fn
  model.layers.10.block_sparse_moe.experts.6
  model.layers.10.block_sparse_moe.experts.6.w1
  model.layers.10.block_sparse_moe.experts.6.w2
  model.layers.10.block_sparse_moe.experts.6.w3
  model.layers.10.block_sparse_moe.experts.6.act_fn
  model.layers.10.block_sparse_moe.experts.7
  model.layers.10.block_sparse_moe.experts.7.w1
  model.layers.10.block_sparse_moe.experts.7.w2
  model.layers.10.block_sparse_moe.experts.7.w3
  model.layers.10.block_sparse_moe.experts.7.act_fn
  model.layers.10.input_layernorm
  model.layers.10.post_attention_layernorm
  model.layers.11
  model.layers.11.self_attn
  model.layers.11.self_attn.q_proj
  model.layers.11.self_attn.k_proj
  model.layers.11.self_attn.v_proj
  model.layers.11.self_attn.o_proj
  model.layers.11.self_attn.rotary_emb
  model.layers.11.block_sparse_moe
  model.layers.11.block_sparse_moe.gate
  model.layers.11.block_sparse_moe.experts
  model.layers.11.block_sparse_moe.experts.0
  model.layers.11.block_sparse_moe.experts.0.w1
  model.layers.11.block_sparse_moe.experts.0.w2
  model.layers.11.block_sparse_moe.experts.0.w3
  model.layers.11.block_sparse_moe.experts.0.act_fn
  model.layers.11.block_sparse_moe.experts.1
  model.layers.11.block_sparse_moe.experts.1.w1
  model.layers.11.block_sparse_moe.experts.1.w2
  model.layers.11.block_sparse_moe.experts.1.w3
  model.layers.11.block_sparse_moe.experts.1.act_fn
  model.layers.11.block_sparse_moe.experts.2
  model.layers.11.block_sparse_moe.experts.2.w1
  model.layers.11.block_sparse_moe.experts.2.w2
  model.layers.11.block_sparse_moe.experts.2.w3
  model.layers.11.block_sparse_moe.experts.2.act_fn
  model.layers.11.block_sparse_moe.experts.3
  model.layers.11.block_sparse_moe.experts.3.w1
  model.layers.11.block_sparse_moe.experts.3.w2
  model.layers.11.block_sparse_moe.experts.3.w3
  model.layers.11.block_sparse_moe.experts.3.act_fn
  model.layers.11.block_sparse_moe.experts.4
  model.layers.11.block_sparse_moe.experts.4.w1
  model.layers.11.block_sparse_moe.experts.4.w2
  model.layers.11.block_sparse_moe.experts.4.w3
  model.layers.11.block_sparse_moe.experts.4.act_fn
  model.layers.11.block_sparse_moe.experts.5
  model.layers.11.block_sparse_moe.experts.5.w1
  model.layers.11.block_sparse_moe.experts.5.w2
  model.layers.11.block_sparse_moe.experts.5.w3
  model.layers.11.block_sparse_moe.experts.5.act_fn
  model.layers.11.block_sparse_moe.experts.6
  model.layers.11.block_sparse_moe.experts.6.w1
  model.layers.11.block_sparse_moe.experts.6.w2
  model.layers.11.block_sparse_moe.experts.6.w3
  model.layers.11.block_sparse_moe.experts.6.act_fn
  model.layers.11.block_sparse_moe.experts.7
  model.layers.11.block_sparse_moe.experts.7.w1
  model.layers.11.block_sparse_moe.experts.7.w2
  model.layers.11.block_sparse_moe.experts.7.w3
  model.layers.11.block_sparse_moe.experts.7.act_fn
  model.layers.11.input_layernorm
  model.layers.11.post_attention_layernorm
  model.layers.12
  model.layers.12.self_attn
  model.layers.12.self_attn.q_proj
  model.layers.12.self_attn.k_proj
  model.layers.12.self_attn.v_proj
  model.layers.12.self_attn.o_proj
  model.layers.12.self_attn.rotary_emb
  model.layers.12.block_sparse_moe
  model.layers.12.block_sparse_moe.gate
  model.layers.12.block_sparse_moe.experts
  model.layers.12.block_sparse_moe.experts.0
  model.layers.12.block_sparse_moe.experts.0.w1
  model.layers.12.block_sparse_moe.experts.0.w2
  model.layers.12.block_sparse_moe.experts.0.w3
  model.layers.12.block_sparse_moe.experts.0.act_fn
  model.layers.12.block_sparse_moe.experts.1
  model.layers.12.block_sparse_moe.experts.1.w1
  model.layers.12.block_sparse_moe.experts.1.w2
  model.layers.12.block_sparse_moe.experts.1.w3
  model.layers.12.block_sparse_moe.experts.1.act_fn
  model.layers.12.block_sparse_moe.experts.2
  model.layers.12.block_sparse_moe.experts.2.w1
  model.layers.12.block_sparse_moe.experts.2.w2
  model.layers.12.block_sparse_moe.experts.2.w3
  model.layers.12.block_sparse_moe.experts.2.act_fn
  model.layers.12.block_sparse_moe.experts.3
  model.layers.12.block_sparse_moe.experts.3.w1
  model.layers.12.block_sparse_moe.experts.3.w2
  model.layers.12.block_sparse_moe.experts.3.w3
  model.layers.12.block_sparse_moe.experts.3.act_fn
  model.layers.12.block_sparse_moe.experts.4
  model.layers.12.block_sparse_moe.experts.4.w1
  model.layers.12.block_sparse_moe.experts.4.w2
  model.layers.12.block_sparse_moe.experts.4.w3
  model.layers.12.block_sparse_moe.experts.4.act_fn
  model.layers.12.block_sparse_moe.experts.5
  model.layers.12.block_sparse_moe.experts.5.w1
  model.layers.12.block_sparse_moe.experts.5.w2
  model.layers.12.block_sparse_moe.experts.5.w3
  model.layers.12.block_sparse_moe.experts.5.act_fn
  model.layers.12.block_sparse_moe.experts.6
  model.layers.12.block_sparse_moe.experts.6.w1
  model.layers.12.block_sparse_moe.experts.6.w2
  model.layers.12.block_sparse_moe.experts.6.w3
  model.layers.12.block_sparse_moe.experts.6.act_fn
  model.layers.12.block_sparse_moe.experts.7
  model.layers.12.block_sparse_moe.experts.7.w1
  model.layers.12.block_sparse_moe.experts.7.w2
  model.layers.12.block_sparse_moe.experts.7.w3
  model.layers.12.block_sparse_moe.experts.7.act_fn
  model.layers.12.input_layernorm
  model.layers.12.post_attention_layernorm
  model.layers.13
  model.layers.13.self_attn
  model.layers.13.self_attn.q_proj
  model.layers.13.self_attn.k_proj
  model.layers.13.self_attn.v_proj
  model.layers.13.self_attn.o_proj
  model.layers.13.self_attn.rotary_emb
  model.layers.13.block_sparse_moe
  model.layers.13.block_sparse_moe.gate
  model.layers.13.block_sparse_moe.experts
  model.layers.13.block_sparse_moe.experts.0
  model.layers.13.block_sparse_moe.experts.0.w1
  model.layers.13.block_sparse_moe.experts.0.w2
  model.layers.13.block_sparse_moe.experts.0.w3
  model.layers.13.block_sparse_moe.experts.0.act_fn
  model.layers.13.block_sparse_moe.experts.1
  model.layers.13.block_sparse_moe.experts.1.w1
  model.layers.13.block_sparse_moe.experts.1.w2
  model.layers.13.block_sparse_moe.experts.1.w3
  model.layers.13.block_sparse_moe.experts.1.act_fn
  model.layers.13.block_sparse_moe.experts.2
  model.layers.13.block_sparse_moe.experts.2.w1
  model.layers.13.block_sparse_moe.experts.2.w2
  model.layers.13.block_sparse_moe.experts.2.w3
  model.layers.13.block_sparse_moe.experts.2.act_fn
  model.layers.13.block_sparse_moe.experts.3
  model.layers.13.block_sparse_moe.experts.3.w1
  model.layers.13.block_sparse_moe.experts.3.w2
  model.layers.13.block_sparse_moe.experts.3.w3
  model.layers.13.block_sparse_moe.experts.3.act_fn
  model.layers.13.block_sparse_moe.experts.4
  model.layers.13.block_sparse_moe.experts.4.w1
  model.layers.13.block_sparse_moe.experts.4.w2
  model.layers.13.block_sparse_moe.experts.4.w3
  model.layers.13.block_sparse_moe.experts.4.act_fn
  model.layers.13.block_sparse_moe.experts.5
  model.layers.13.block_sparse_moe.experts.5.w1
  model.layers.13.block_sparse_moe.experts.5.w2
  model.layers.13.block_sparse_moe.experts.5.w3
  model.layers.13.block_sparse_moe.experts.5.act_fn
  model.layers.13.block_sparse_moe.experts.6
  model.layers.13.block_sparse_moe.experts.6.w1
  model.layers.13.block_sparse_moe.experts.6.w2
  model.layers.13.block_sparse_moe.experts.6.w3
  model.layers.13.block_sparse_moe.experts.6.act_fn
  model.layers.13.block_sparse_moe.experts.7
  model.layers.13.block_sparse_moe.experts.7.w1
  model.layers.13.block_sparse_moe.experts.7.w2
  model.layers.13.block_sparse_moe.experts.7.w3
  model.layers.13.block_sparse_moe.experts.7.act_fn
  model.layers.13.input_layernorm
  model.layers.13.post_attention_layernorm
  model.layers.14
  model.layers.14.self_attn
  model.layers.14.self_attn.q_proj
  model.layers.14.self_attn.k_proj
  model.layers.14.self_attn.v_proj
  model.layers.14.self_attn.o_proj
  model.layers.14.self_attn.rotary_emb
  model.layers.14.block_sparse_moe
  model.layers.14.block_sparse_moe.gate
  model.layers.14.block_sparse_moe.experts
  model.layers.14.block_sparse_moe.experts.0
  model.layers.14.block_sparse_moe.experts.0.w1
  model.layers.14.block_sparse_moe.experts.0.w2
  model.layers.14.block_sparse_moe.experts.0.w3
  model.layers.14.block_sparse_moe.experts.0.act_fn
  model.layers.14.block_sparse_moe.experts.1
  model.layers.14.block_sparse_moe.experts.1.w1
  model.layers.14.block_sparse_moe.experts.1.w2
  model.layers.14.block_sparse_moe.experts.1.w3
  model.layers.14.block_sparse_moe.experts.1.act_fn
  model.layers.14.block_sparse_moe.experts.2
  model.layers.14.block_sparse_moe.experts.2.w1
  model.layers.14.block_sparse_moe.experts.2.w2
  model.layers.14.block_sparse_moe.experts.2.w3
  model.layers.14.block_sparse_moe.experts.2.act_fn
  model.layers.14.block_sparse_moe.experts.3
  model.layers.14.block_sparse_moe.experts.3.w1
  model.layers.14.block_sparse_moe.experts.3.w2
  model.layers.14.block_sparse_moe.experts.3.w3
  model.layers.14.block_sparse_moe.experts.3.act_fn
  model.layers.14.block_sparse_moe.experts.4
  model.layers.14.block_sparse_moe.experts.4.w1
  model.layers.14.block_sparse_moe.experts.4.w2
  model.layers.14.block_sparse_moe.experts.4.w3
  model.layers.14.block_sparse_moe.experts.4.act_fn
  model.layers.14.block_sparse_moe.experts.5
  model.layers.14.block_sparse_moe.experts.5.w1
  model.layers.14.block_sparse_moe.experts.5.w2
  model.layers.14.block_sparse_moe.experts.5.w3
  model.layers.14.block_sparse_moe.experts.5.act_fn
  model.layers.14.block_sparse_moe.experts.6
  model.layers.14.block_sparse_moe.experts.6.w1
  model.layers.14.block_sparse_moe.experts.6.w2
  model.layers.14.block_sparse_moe.experts.6.w3
  model.layers.14.block_sparse_moe.experts.6.act_fn
  model.layers.14.block_sparse_moe.experts.7
  model.layers.14.block_sparse_moe.experts.7.w1
  model.layers.14.block_sparse_moe.experts.7.w2
  model.layers.14.block_sparse_moe.experts.7.w3
  model.layers.14.block_sparse_moe.experts.7.act_fn
  model.layers.14.input_layernorm
  model.layers.14.post_attention_layernorm
  model.layers.15
  model.layers.15.self_attn
  model.layers.15.self_attn.q_proj
  model.layers.15.self_attn.k_proj
  model.layers.15.self_attn.v_proj
  model.layers.15.self_attn.o_proj
  model.layers.15.self_attn.rotary_emb
  model.layers.15.block_sparse_moe
  model.layers.15.block_sparse_moe.gate
  model.layers.15.block_sparse_moe.experts
  model.layers.15.block_sparse_moe.experts.0
  model.layers.15.block_sparse_moe.experts.0.w1
  model.layers.15.block_sparse_moe.experts.0.w2
  model.layers.15.block_sparse_moe.experts.0.w3
  model.layers.15.block_sparse_moe.experts.0.act_fn
  model.layers.15.block_sparse_moe.experts.1
  model.layers.15.block_sparse_moe.experts.1.w1
  model.layers.15.block_sparse_moe.experts.1.w2
  model.layers.15.block_sparse_moe.experts.1.w3
  model.layers.15.block_sparse_moe.experts.1.act_fn
  model.layers.15.block_sparse_moe.experts.2
  model.layers.15.block_sparse_moe.experts.2.w1
  model.layers.15.block_sparse_moe.experts.2.w2
  model.layers.15.block_sparse_moe.experts.2.w3
  model.layers.15.block_sparse_moe.experts.2.act_fn
  model.layers.15.block_sparse_moe.experts.3
  model.layers.15.block_sparse_moe.experts.3.w1
  model.layers.15.block_sparse_moe.experts.3.w2
  model.layers.15.block_sparse_moe.experts.3.w3
  model.layers.15.block_sparse_moe.experts.3.act_fn
  model.layers.15.block_sparse_moe.experts.4
  model.layers.15.block_sparse_moe.experts.4.w1
  model.layers.15.block_sparse_moe.experts.4.w2
  model.layers.15.block_sparse_moe.experts.4.w3
  model.layers.15.block_sparse_moe.experts.4.act_fn
  model.layers.15.block_sparse_moe.experts.5
  model.layers.15.block_sparse_moe.experts.5.w1
  model.layers.15.block_sparse_moe.experts.5.w2
  model.layers.15.block_sparse_moe.experts.5.w3
  model.layers.15.block_sparse_moe.experts.5.act_fn
  model.layers.15.block_sparse_moe.experts.6
  model.layers.15.block_sparse_moe.experts.6.w1
  model.layers.15.block_sparse_moe.experts.6.w2
  model.layers.15.block_sparse_moe.experts.6.w3
  model.layers.15.block_sparse_moe.experts.6.act_fn
  model.layers.15.block_sparse_moe.experts.7
  model.layers.15.block_sparse_moe.experts.7.w1
  model.layers.15.block_sparse_moe.experts.7.w2
  model.layers.15.block_sparse_moe.experts.7.w3
  model.layers.15.block_sparse_moe.experts.7.act_fn
  model.layers.15.input_layernorm
  model.layers.15.post_attention_layernorm
  model.layers.16
  model.layers.16.self_attn
  model.layers.16.self_attn.q_proj
  model.layers.16.self_attn.k_proj
  model.layers.16.self_attn.v_proj
  model.layers.16.self_attn.o_proj
  model.layers.16.self_attn.rotary_emb
  model.layers.16.block_sparse_moe
  model.layers.16.block_sparse_moe.gate
  model.layers.16.block_sparse_moe.experts
  model.layers.16.block_sparse_moe.experts.0
  model.layers.16.block_sparse_moe.experts.0.w1
  model.layers.16.block_sparse_moe.experts.0.w2
  model.layers.16.block_sparse_moe.experts.0.w3
  model.layers.16.block_sparse_moe.experts.0.act_fn
  model.layers.16.block_sparse_moe.experts.1
  model.layers.16.block_sparse_moe.experts.1.w1
  model.layers.16.block_sparse_moe.experts.1.w2
  model.layers.16.block_sparse_moe.experts.1.w3
  model.layers.16.block_sparse_moe.experts.1.act_fn
  model.layers.16.block_sparse_moe.experts.2
  model.layers.16.block_sparse_moe.experts.2.w1
  model.layers.16.block_sparse_moe.experts.2.w2
  model.layers.16.block_sparse_moe.experts.2.w3
  model.layers.16.block_sparse_moe.experts.2.act_fn
  model.layers.16.block_sparse_moe.experts.3
  model.layers.16.block_sparse_moe.experts.3.w1
  model.layers.16.block_sparse_moe.experts.3.w2
  model.layers.16.block_sparse_moe.experts.3.w3
  model.layers.16.block_sparse_moe.experts.3.act_fn
  model.layers.16.block_sparse_moe.experts.4
  model.layers.16.block_sparse_moe.experts.4.w1
  model.layers.16.block_sparse_moe.experts.4.w2
  model.layers.16.block_sparse_moe.experts.4.w3
  model.layers.16.block_sparse_moe.experts.4.act_fn
  model.layers.16.block_sparse_moe.experts.5
  model.layers.16.block_sparse_moe.experts.5.w1
  model.layers.16.block_sparse_moe.experts.5.w2
  model.layers.16.block_sparse_moe.experts.5.w3
  model.layers.16.block_sparse_moe.experts.5.act_fn
  model.layers.16.block_sparse_moe.experts.6
  model.layers.16.block_sparse_moe.experts.6.w1
  model.layers.16.block_sparse_moe.experts.6.w2
  model.layers.16.block_sparse_moe.experts.6.w3
  model.layers.16.block_sparse_moe.experts.6.act_fn
  model.layers.16.block_sparse_moe.experts.7
  model.layers.16.block_sparse_moe.experts.7.w1
  model.layers.16.block_sparse_moe.experts.7.w2
  model.layers.16.block_sparse_moe.experts.7.w3
  model.layers.16.block_sparse_moe.experts.7.act_fn
  model.layers.16.input_layernorm
  model.layers.16.post_attention_layernorm
  model.layers.17
  model.layers.17.self_attn
  model.layers.17.self_attn.q_proj
  model.layers.17.self_attn.k_proj
  model.layers.17.self_attn.v_proj
  model.layers.17.self_attn.o_proj
  model.layers.17.self_attn.rotary_emb
  model.layers.17.block_sparse_moe
  model.layers.17.block_sparse_moe.gate
  model.layers.17.block_sparse_moe.experts
  model.layers.17.block_sparse_moe.experts.0
  model.layers.17.block_sparse_moe.experts.0.w1
  model.layers.17.block_sparse_moe.experts.0.w2
  model.layers.17.block_sparse_moe.experts.0.w3
  model.layers.17.block_sparse_moe.experts.0.act_fn
  model.layers.17.block_sparse_moe.experts.1
  model.layers.17.block_sparse_moe.experts.1.w1
  model.layers.17.block_sparse_moe.experts.1.w2
  model.layers.17.block_sparse_moe.experts.1.w3
  model.layers.17.block_sparse_moe.experts.1.act_fn
  model.layers.17.block_sparse_moe.experts.2
  model.layers.17.block_sparse_moe.experts.2.w1
  model.layers.17.block_sparse_moe.experts.2.w2
  model.layers.17.block_sparse_moe.experts.2.w3
  model.layers.17.block_sparse_moe.experts.2.act_fn
  model.layers.17.block_sparse_moe.experts.3
  model.layers.17.block_sparse_moe.experts.3.w1
  model.layers.17.block_sparse_moe.experts.3.w2
  model.layers.17.block_sparse_moe.experts.3.w3
  model.layers.17.block_sparse_moe.experts.3.act_fn
  model.layers.17.block_sparse_moe.experts.4
  model.layers.17.block_sparse_moe.experts.4.w1
  model.layers.17.block_sparse_moe.experts.4.w2
  model.layers.17.block_sparse_moe.experts.4.w3
  model.layers.17.block_sparse_moe.experts.4.act_fn
  model.layers.17.block_sparse_moe.experts.5
  model.layers.17.block_sparse_moe.experts.5.w1
  model.layers.17.block_sparse_moe.experts.5.w2
  model.layers.17.block_sparse_moe.experts.5.w3
  model.layers.17.block_sparse_moe.experts.5.act_fn
  model.layers.17.block_sparse_moe.experts.6
  model.layers.17.block_sparse_moe.experts.6.w1
  model.layers.17.block_sparse_moe.experts.6.w2
  model.layers.17.block_sparse_moe.experts.6.w3
  model.layers.17.block_sparse_moe.experts.6.act_fn
  model.layers.17.block_sparse_moe.experts.7
  model.layers.17.block_sparse_moe.experts.7.w1
  model.layers.17.block_sparse_moe.experts.7.w2
  model.layers.17.block_sparse_moe.experts.7.w3
  model.layers.17.block_sparse_moe.experts.7.act_fn
  model.layers.17.input_layernorm
  model.layers.17.post_attention_layernorm
  model.layers.18
  model.layers.18.self_attn
  model.layers.18.self_attn.q_proj
  model.layers.18.self_attn.k_proj
  model.layers.18.self_attn.v_proj
  model.layers.18.self_attn.o_proj
  model.layers.18.self_attn.rotary_emb
  model.layers.18.block_sparse_moe
  model.layers.18.block_sparse_moe.gate
  model.layers.18.block_sparse_moe.experts
  model.layers.18.block_sparse_moe.experts.0
  model.layers.18.block_sparse_moe.experts.0.w1
  model.layers.18.block_sparse_moe.experts.0.w2
  model.layers.18.block_sparse_moe.experts.0.w3
  model.layers.18.block_sparse_moe.experts.0.act_fn
  model.layers.18.block_sparse_moe.experts.1
  model.layers.18.block_sparse_moe.experts.1.w1
  model.layers.18.block_sparse_moe.experts.1.w2
  model.layers.18.block_sparse_moe.experts.1.w3
  model.layers.18.block_sparse_moe.experts.1.act_fn
  model.layers.18.block_sparse_moe.experts.2
  model.layers.18.block_sparse_moe.experts.2.w1
  model.layers.18.block_sparse_moe.experts.2.w2
  model.layers.18.block_sparse_moe.experts.2.w3
  model.layers.18.block_sparse_moe.experts.2.act_fn
  model.layers.18.block_sparse_moe.experts.3
  model.layers.18.block_sparse_moe.experts.3.w1
  model.layers.18.block_sparse_moe.experts.3.w2
  model.layers.18.block_sparse_moe.experts.3.w3
  model.layers.18.block_sparse_moe.experts.3.act_fn
  model.layers.18.block_sparse_moe.experts.4
  model.layers.18.block_sparse_moe.experts.4.w1
  model.layers.18.block_sparse_moe.experts.4.w2
  model.layers.18.block_sparse_moe.experts.4.w3
  model.layers.18.block_sparse_moe.experts.4.act_fn
  model.layers.18.block_sparse_moe.experts.5
  model.layers.18.block_sparse_moe.experts.5.w1
  model.layers.18.block_sparse_moe.experts.5.w2
  model.layers.18.block_sparse_moe.experts.5.w3
  model.layers.18.block_sparse_moe.experts.5.act_fn
  model.layers.18.block_sparse_moe.experts.6
  model.layers.18.block_sparse_moe.experts.6.w1
  model.layers.18.block_sparse_moe.experts.6.w2
  model.layers.18.block_sparse_moe.experts.6.w3
  model.layers.18.block_sparse_moe.experts.6.act_fn
  model.layers.18.block_sparse_moe.experts.7
  model.layers.18.block_sparse_moe.experts.7.w1
  model.layers.18.block_sparse_moe.experts.7.w2
  model.layers.18.block_sparse_moe.experts.7.w3
  model.layers.18.block_sparse_moe.experts.7.act_fn
  model.layers.18.input_layernorm
  model.layers.18.post_attention_layernorm
  model.layers.19
  model.layers.19.self_attn
  model.layers.19.self_attn.q_proj
  model.layers.19.self_attn.k_proj
  model.layers.19.self_attn.v_proj
  model.layers.19.self_attn.o_proj
  model.layers.19.self_attn.rotary_emb
  model.layers.19.block_sparse_moe
  model.layers.19.block_sparse_moe.gate
  model.layers.19.block_sparse_moe.experts
  model.layers.19.block_sparse_moe.experts.0
  model.layers.19.block_sparse_moe.experts.0.w1
  model.layers.19.block_sparse_moe.experts.0.w2
  model.layers.19.block_sparse_moe.experts.0.w3
  model.layers.19.block_sparse_moe.experts.0.act_fn
  model.layers.19.block_sparse_moe.experts.1
  model.layers.19.block_sparse_moe.experts.1.w1
  model.layers.19.block_sparse_moe.experts.1.w2
  model.layers.19.block_sparse_moe.experts.1.w3
  model.layers.19.block_sparse_moe.experts.1.act_fn
  model.layers.19.block_sparse_moe.experts.2
  model.layers.19.block_sparse_moe.experts.2.w1
  model.layers.19.block_sparse_moe.experts.2.w2
  model.layers.19.block_sparse_moe.experts.2.w3
  model.layers.19.block_sparse_moe.experts.2.act_fn
  model.layers.19.block_sparse_moe.experts.3
  model.layers.19.block_sparse_moe.experts.3.w1
  model.layers.19.block_sparse_moe.experts.3.w2
  model.layers.19.block_sparse_moe.experts.3.w3
  model.layers.19.block_sparse_moe.experts.3.act_fn
  model.layers.19.block_sparse_moe.experts.4
  model.layers.19.block_sparse_moe.experts.4.w1
  model.layers.19.block_sparse_moe.experts.4.w2
  model.layers.19.block_sparse_moe.experts.4.w3
  model.layers.19.block_sparse_moe.experts.4.act_fn
  model.layers.19.block_sparse_moe.experts.5
  model.layers.19.block_sparse_moe.experts.5.w1
  model.layers.19.block_sparse_moe.experts.5.w2
  model.layers.19.block_sparse_moe.experts.5.w3
  model.layers.19.block_sparse_moe.experts.5.act_fn
  model.layers.19.block_sparse_moe.experts.6
  model.layers.19.block_sparse_moe.experts.6.w1
  model.layers.19.block_sparse_moe.experts.6.w2
  model.layers.19.block_sparse_moe.experts.6.w3
  model.layers.19.block_sparse_moe.experts.6.act_fn
  model.layers.19.block_sparse_moe.experts.7
  model.layers.19.block_sparse_moe.experts.7.w1
  model.layers.19.block_sparse_moe.experts.7.w2
  model.layers.19.block_sparse_moe.experts.7.w3
  model.layers.19.block_sparse_moe.experts.7.act_fn
  model.layers.19.input_layernorm
  model.layers.19.post_attention_layernorm
  model.layers.20
  model.layers.20.self_attn
  model.layers.20.self_attn.q_proj
  model.layers.20.self_attn.k_proj
  model.layers.20.self_attn.v_proj
  model.layers.20.self_attn.o_proj
  model.layers.20.self_attn.rotary_emb
  model.layers.20.block_sparse_moe
  model.layers.20.block_sparse_moe.gate
  model.layers.20.block_sparse_moe.experts
  model.layers.20.block_sparse_moe.experts.0
  model.layers.20.block_sparse_moe.experts.0.w1
  model.layers.20.block_sparse_moe.experts.0.w2
  model.layers.20.block_sparse_moe.experts.0.w3
  model.layers.20.block_sparse_moe.experts.0.act_fn
  model.layers.20.block_sparse_moe.experts.1
  model.layers.20.block_sparse_moe.experts.1.w1
  model.layers.20.block_sparse_moe.experts.1.w2
  model.layers.20.block_sparse_moe.experts.1.w3
  model.layers.20.block_sparse_moe.experts.1.act_fn
  model.layers.20.block_sparse_moe.experts.2
  model.layers.20.block_sparse_moe.experts.2.w1
  model.layers.20.block_sparse_moe.experts.2.w2
  model.layers.20.block_sparse_moe.experts.2.w3
  model.layers.20.block_sparse_moe.experts.2.act_fn
  model.layers.20.block_sparse_moe.experts.3
  model.layers.20.block_sparse_moe.experts.3.w1
  model.layers.20.block_sparse_moe.experts.3.w2
  model.layers.20.block_sparse_moe.experts.3.w3
  model.layers.20.block_sparse_moe.experts.3.act_fn
  model.layers.20.block_sparse_moe.experts.4
  model.layers.20.block_sparse_moe.experts.4.w1
  model.layers.20.block_sparse_moe.experts.4.w2
  model.layers.20.block_sparse_moe.experts.4.w3
  model.layers.20.block_sparse_moe.experts.4.act_fn
  model.layers.20.block_sparse_moe.experts.5
  model.layers.20.block_sparse_moe.experts.5.w1
  model.layers.20.block_sparse_moe.experts.5.w2
  model.layers.20.block_sparse_moe.experts.5.w3
  model.layers.20.block_sparse_moe.experts.5.act_fn
  model.layers.20.block_sparse_moe.experts.6
  model.layers.20.block_sparse_moe.experts.6.w1
  model.layers.20.block_sparse_moe.experts.6.w2
  model.layers.20.block_sparse_moe.experts.6.w3
  model.layers.20.block_sparse_moe.experts.6.act_fn
  model.layers.20.block_sparse_moe.experts.7
  model.layers.20.block_sparse_moe.experts.7.w1
  model.layers.20.block_sparse_moe.experts.7.w2
  model.layers.20.block_sparse_moe.experts.7.w3
  model.layers.20.block_sparse_moe.experts.7.act_fn
  model.layers.20.input_layernorm
  model.layers.20.post_attention_layernorm
  model.layers.21
  model.layers.21.self_attn
  model.layers.21.self_attn.q_proj
  model.layers.21.self_attn.k_proj
  model.layers.21.self_attn.v_proj
  model.layers.21.self_attn.o_proj
  model.layers.21.self_attn.rotary_emb
  model.layers.21.block_sparse_moe
  model.layers.21.block_sparse_moe.gate
  model.layers.21.block_sparse_moe.experts
  model.layers.21.block_sparse_moe.experts.0
  model.layers.21.block_sparse_moe.experts.0.w1
  model.layers.21.block_sparse_moe.experts.0.w2
  model.layers.21.block_sparse_moe.experts.0.w3
  model.layers.21.block_sparse_moe.experts.0.act_fn
  model.layers.21.block_sparse_moe.experts.1
  model.layers.21.block_sparse_moe.experts.1.w1
  model.layers.21.block_sparse_moe.experts.1.w2
  model.layers.21.block_sparse_moe.experts.1.w3
  model.layers.21.block_sparse_moe.experts.1.act_fn
  model.layers.21.block_sparse_moe.experts.2
  model.layers.21.block_sparse_moe.experts.2.w1
  model.layers.21.block_sparse_moe.experts.2.w2
  model.layers.21.block_sparse_moe.experts.2.w3
  model.layers.21.block_sparse_moe.experts.2.act_fn
  model.layers.21.block_sparse_moe.experts.3
  model.layers.21.block_sparse_moe.experts.3.w1
  model.layers.21.block_sparse_moe.experts.3.w2
  model.layers.21.block_sparse_moe.experts.3.w3
  model.layers.21.block_sparse_moe.experts.3.act_fn
  model.layers.21.block_sparse_moe.experts.4
  model.layers.21.block_sparse_moe.experts.4.w1
  model.layers.21.block_sparse_moe.experts.4.w2
  model.layers.21.block_sparse_moe.experts.4.w3
  model.layers.21.block_sparse_moe.experts.4.act_fn
  model.layers.21.block_sparse_moe.experts.5
  model.layers.21.block_sparse_moe.experts.5.w1
  model.layers.21.block_sparse_moe.experts.5.w2
  model.layers.21.block_sparse_moe.experts.5.w3
  model.layers.21.block_sparse_moe.experts.5.act_fn
  model.layers.21.block_sparse_moe.experts.6
  model.layers.21.block_sparse_moe.experts.6.w1
  model.layers.21.block_sparse_moe.experts.6.w2
  model.layers.21.block_sparse_moe.experts.6.w3
  model.layers.21.block_sparse_moe.experts.6.act_fn
  model.layers.21.block_sparse_moe.experts.7
  model.layers.21.block_sparse_moe.experts.7.w1
  model.layers.21.block_sparse_moe.experts.7.w2
  model.layers.21.block_sparse_moe.experts.7.w3
  model.layers.21.block_sparse_moe.experts.7.act_fn
  model.layers.21.input_layernorm
  model.layers.21.post_attention_layernorm
  model.layers.22
  model.layers.22.self_attn
  model.layers.22.self_attn.q_proj
  model.layers.22.self_attn.k_proj
  model.layers.22.self_attn.v_proj
  model.layers.22.self_attn.o_proj
  model.layers.22.self_attn.rotary_emb
  model.layers.22.block_sparse_moe
  model.layers.22.block_sparse_moe.gate
  model.layers.22.block_sparse_moe.experts
  model.layers.22.block_sparse_moe.experts.0
  model.layers.22.block_sparse_moe.experts.0.w1
  model.layers.22.block_sparse_moe.experts.0.w2
  model.layers.22.block_sparse_moe.experts.0.w3
  model.layers.22.block_sparse_moe.experts.0.act_fn
  model.layers.22.block_sparse_moe.experts.1
  model.layers.22.block_sparse_moe.experts.1.w1
  model.layers.22.block_sparse_moe.experts.1.w2
  model.layers.22.block_sparse_moe.experts.1.w3
  model.layers.22.block_sparse_moe.experts.1.act_fn
  model.layers.22.block_sparse_moe.experts.2
  model.layers.22.block_sparse_moe.experts.2.w1
  model.layers.22.block_sparse_moe.experts.2.w2
  model.layers.22.block_sparse_moe.experts.2.w3
  model.layers.22.block_sparse_moe.experts.2.act_fn
  model.layers.22.block_sparse_moe.experts.3
  model.layers.22.block_sparse_moe.experts.3.w1
  model.layers.22.block_sparse_moe.experts.3.w2
  model.layers.22.block_sparse_moe.experts.3.w3
  model.layers.22.block_sparse_moe.experts.3.act_fn
  model.layers.22.block_sparse_moe.experts.4
  model.layers.22.block_sparse_moe.experts.4.w1
  model.layers.22.block_sparse_moe.experts.4.w2
  model.layers.22.block_sparse_moe.experts.4.w3
  model.layers.22.block_sparse_moe.experts.4.act_fn
  model.layers.22.block_sparse_moe.experts.5
  model.layers.22.block_sparse_moe.experts.5.w1
  model.layers.22.block_sparse_moe.experts.5.w2
  model.layers.22.block_sparse_moe.experts.5.w3
  model.layers.22.block_sparse_moe.experts.5.act_fn
  model.layers.22.block_sparse_moe.experts.6
  model.layers.22.block_sparse_moe.experts.6.w1
  model.layers.22.block_sparse_moe.experts.6.w2
  model.layers.22.block_sparse_moe.experts.6.w3
  model.layers.22.block_sparse_moe.experts.6.act_fn
  model.layers.22.block_sparse_moe.experts.7
  model.layers.22.block_sparse_moe.experts.7.w1
  model.layers.22.block_sparse_moe.experts.7.w2
  model.layers.22.block_sparse_moe.experts.7.w3
  model.layers.22.block_sparse_moe.experts.7.act_fn
  model.layers.22.input_layernorm
  model.layers.22.post_attention_layernorm
  model.layers.23
  model.layers.23.self_attn
  model.layers.23.self_attn.q_proj
  model.layers.23.self_attn.k_proj
  model.layers.23.self_attn.v_proj
  model.layers.23.self_attn.o_proj
  model.layers.23.self_attn.rotary_emb
  model.layers.23.block_sparse_moe
  model.layers.23.block_sparse_moe.gate
  model.layers.23.block_sparse_moe.experts
  model.layers.23.block_sparse_moe.experts.0
  model.layers.23.block_sparse_moe.experts.0.w1
  model.layers.23.block_sparse_moe.experts.0.w2
  model.layers.23.block_sparse_moe.experts.0.w3
  model.layers.23.block_sparse_moe.experts.0.act_fn
  model.layers.23.block_sparse_moe.experts.1
  model.layers.23.block_sparse_moe.experts.1.w1
  model.layers.23.block_sparse_moe.experts.1.w2
  model.layers.23.block_sparse_moe.experts.1.w3
  model.layers.23.block_sparse_moe.experts.1.act_fn
  model.layers.23.block_sparse_moe.experts.2
  model.layers.23.block_sparse_moe.experts.2.w1
  model.layers.23.block_sparse_moe.experts.2.w2
  model.layers.23.block_sparse_moe.experts.2.w3
  model.layers.23.block_sparse_moe.experts.2.act_fn
  model.layers.23.block_sparse_moe.experts.3
  model.layers.23.block_sparse_moe.experts.3.w1
  model.layers.23.block_sparse_moe.experts.3.w2
  model.layers.23.block_sparse_moe.experts.3.w3
  model.layers.23.block_sparse_moe.experts.3.act_fn
  model.layers.23.block_sparse_moe.experts.4
  model.layers.23.block_sparse_moe.experts.4.w1
  model.layers.23.block_sparse_moe.experts.4.w2
  model.layers.23.block_sparse_moe.experts.4.w3
  model.layers.23.block_sparse_moe.experts.4.act_fn
  model.layers.23.block_sparse_moe.experts.5
  model.layers.23.block_sparse_moe.experts.5.w1
  model.layers.23.block_sparse_moe.experts.5.w2
  model.layers.23.block_sparse_moe.experts.5.w3
  model.layers.23.block_sparse_moe.experts.5.act_fn
  model.layers.23.block_sparse_moe.experts.6
  model.layers.23.block_sparse_moe.experts.6.w1
  model.layers.23.block_sparse_moe.experts.6.w2
  model.layers.23.block_sparse_moe.experts.6.w3
  model.layers.23.block_sparse_moe.experts.6.act_fn
  model.layers.23.block_sparse_moe.experts.7
  model.layers.23.block_sparse_moe.experts.7.w1
  model.layers.23.block_sparse_moe.experts.7.w2
  model.layers.23.block_sparse_moe.experts.7.w3
  model.layers.23.block_sparse_moe.experts.7.act_fn
  model.layers.23.input_layernorm
  model.layers.23.post_attention_layernorm
  model.layers.24
  model.layers.24.self_attn
  model.layers.24.self_attn.q_proj
  model.layers.24.self_attn.k_proj
  model.layers.24.self_attn.v_proj
  model.layers.24.self_attn.o_proj
  model.layers.24.self_attn.rotary_emb
  model.layers.24.block_sparse_moe
  model.layers.24.block_sparse_moe.gate
  model.layers.24.block_sparse_moe.experts
  model.layers.24.block_sparse_moe.experts.0
  model.layers.24.block_sparse_moe.experts.0.w1
  model.layers.24.block_sparse_moe.experts.0.w2
  model.layers.24.block_sparse_moe.experts.0.w3
  model.layers.24.block_sparse_moe.experts.0.act_fn
  model.layers.24.block_sparse_moe.experts.1
  model.layers.24.block_sparse_moe.experts.1.w1
  model.layers.24.block_sparse_moe.experts.1.w2
  model.layers.24.block_sparse_moe.experts.1.w3
  model.layers.24.block_sparse_moe.experts.1.act_fn
  model.layers.24.block_sparse_moe.experts.2
  model.layers.24.block_sparse_moe.experts.2.w1
  model.layers.24.block_sparse_moe.experts.2.w2
  model.layers.24.block_sparse_moe.experts.2.w3
  model.layers.24.block_sparse_moe.experts.2.act_fn
  model.layers.24.block_sparse_moe.experts.3
  model.layers.24.block_sparse_moe.experts.3.w1
  model.layers.24.block_sparse_moe.experts.3.w2
  model.layers.24.block_sparse_moe.experts.3.w3
  model.layers.24.block_sparse_moe.experts.3.act_fn
  model.layers.24.block_sparse_moe.experts.4
  model.layers.24.block_sparse_moe.experts.4.w1
  model.layers.24.block_sparse_moe.experts.4.w2
  model.layers.24.block_sparse_moe.experts.4.w3
  model.layers.24.block_sparse_moe.experts.4.act_fn
  model.layers.24.block_sparse_moe.experts.5
  model.layers.24.block_sparse_moe.experts.5.w1
  model.layers.24.block_sparse_moe.experts.5.w2
  model.layers.24.block_sparse_moe.experts.5.w3
  model.layers.24.block_sparse_moe.experts.5.act_fn
  model.layers.24.block_sparse_moe.experts.6
  model.layers.24.block_sparse_moe.experts.6.w1
  model.layers.24.block_sparse_moe.experts.6.w2
  model.layers.24.block_sparse_moe.experts.6.w3
  model.layers.24.block_sparse_moe.experts.6.act_fn
  model.layers.24.block_sparse_moe.experts.7
  model.layers.24.block_sparse_moe.experts.7.w1
  model.layers.24.block_sparse_moe.experts.7.w2
  model.layers.24.block_sparse_moe.experts.7.w3
  model.layers.24.block_sparse_moe.experts.7.act_fn
  model.layers.24.input_layernorm
  model.layers.24.post_attention_layernorm
  model.layers.25
  model.layers.25.self_attn
  model.layers.25.self_attn.q_proj
  model.layers.25.self_attn.k_proj
  model.layers.25.self_attn.v_proj
  model.layers.25.self_attn.o_proj
  model.layers.25.self_attn.rotary_emb
  model.layers.25.block_sparse_moe
  model.layers.25.block_sparse_moe.gate
  model.layers.25.block_sparse_moe.experts
  model.layers.25.block_sparse_moe.experts.0
  model.layers.25.block_sparse_moe.experts.0.w1
  model.layers.25.block_sparse_moe.experts.0.w2
  model.layers.25.block_sparse_moe.experts.0.w3
  model.layers.25.block_sparse_moe.experts.0.act_fn
  model.layers.25.block_sparse_moe.experts.1
  model.layers.25.block_sparse_moe.experts.1.w1
  model.layers.25.block_sparse_moe.experts.1.w2
  model.layers.25.block_sparse_moe.experts.1.w3
  model.layers.25.block_sparse_moe.experts.1.act_fn
  model.layers.25.block_sparse_moe.experts.2
  model.layers.25.block_sparse_moe.experts.2.w1
  model.layers.25.block_sparse_moe.experts.2.w2
  model.layers.25.block_sparse_moe.experts.2.w3
  model.layers.25.block_sparse_moe.experts.2.act_fn
  model.layers.25.block_sparse_moe.experts.3
  model.layers.25.block_sparse_moe.experts.3.w1
  model.layers.25.block_sparse_moe.experts.3.w2
  model.layers.25.block_sparse_moe.experts.3.w3
  model.layers.25.block_sparse_moe.experts.3.act_fn
  model.layers.25.block_sparse_moe.experts.4
  model.layers.25.block_sparse_moe.experts.4.w1
  model.layers.25.block_sparse_moe.experts.4.w2
  model.layers.25.block_sparse_moe.experts.4.w3
  model.layers.25.block_sparse_moe.experts.4.act_fn
  model.layers.25.block_sparse_moe.experts.5
  model.layers.25.block_sparse_moe.experts.5.w1
  model.layers.25.block_sparse_moe.experts.5.w2
  model.layers.25.block_sparse_moe.experts.5.w3
  model.layers.25.block_sparse_moe.experts.5.act_fn
  model.layers.25.block_sparse_moe.experts.6
  model.layers.25.block_sparse_moe.experts.6.w1
  model.layers.25.block_sparse_moe.experts.6.w2
  model.layers.25.block_sparse_moe.experts.6.w3
  model.layers.25.block_sparse_moe.experts.6.act_fn
  model.layers.25.block_sparse_moe.experts.7
  model.layers.25.block_sparse_moe.experts.7.w1
  model.layers.25.block_sparse_moe.experts.7.w2
  model.layers.25.block_sparse_moe.experts.7.w3
  model.layers.25.block_sparse_moe.experts.7.act_fn
  model.layers.25.input_layernorm
  model.layers.25.post_attention_layernorm
  model.layers.26
  model.layers.26.self_attn
  model.layers.26.self_attn.q_proj
  model.layers.26.self_attn.k_proj
  model.layers.26.self_attn.v_proj
  model.layers.26.self_attn.o_proj
  model.layers.26.self_attn.rotary_emb
  model.layers.26.block_sparse_moe
  model.layers.26.block_sparse_moe.gate
  model.layers.26.block_sparse_moe.experts
  model.layers.26.block_sparse_moe.experts.0
  model.layers.26.block_sparse_moe.experts.0.w1
  model.layers.26.block_sparse_moe.experts.0.w2
  model.layers.26.block_sparse_moe.experts.0.w3
  model.layers.26.block_sparse_moe.experts.0.act_fn
  model.layers.26.block_sparse_moe.experts.1
  model.layers.26.block_sparse_moe.experts.1.w1
  model.layers.26.block_sparse_moe.experts.1.w2
  model.layers.26.block_sparse_moe.experts.1.w3
  model.layers.26.block_sparse_moe.experts.1.act_fn
  model.layers.26.block_sparse_moe.experts.2
  model.layers.26.block_sparse_moe.experts.2.w1
  model.layers.26.block_sparse_moe.experts.2.w2
  model.layers.26.block_sparse_moe.experts.2.w3
  model.layers.26.block_sparse_moe.experts.2.act_fn
  model.layers.26.block_sparse_moe.experts.3
  model.layers.26.block_sparse_moe.experts.3.w1
  model.layers.26.block_sparse_moe.experts.3.w2
  model.layers.26.block_sparse_moe.experts.3.w3
  model.layers.26.block_sparse_moe.experts.3.act_fn
  model.layers.26.block_sparse_moe.experts.4
  model.layers.26.block_sparse_moe.experts.4.w1
  model.layers.26.block_sparse_moe.experts.4.w2
  model.layers.26.block_sparse_moe.experts.4.w3
  model.layers.26.block_sparse_moe.experts.4.act_fn
  model.layers.26.block_sparse_moe.experts.5
  model.layers.26.block_sparse_moe.experts.5.w1
  model.layers.26.block_sparse_moe.experts.5.w2
  model.layers.26.block_sparse_moe.experts.5.w3
  model.layers.26.block_sparse_moe.experts.5.act_fn
  model.layers.26.block_sparse_moe.experts.6
  model.layers.26.block_sparse_moe.experts.6.w1
  model.layers.26.block_sparse_moe.experts.6.w2
  model.layers.26.block_sparse_moe.experts.6.w3
  model.layers.26.block_sparse_moe.experts.6.act_fn
  model.layers.26.block_sparse_moe.experts.7
  model.layers.26.block_sparse_moe.experts.7.w1
  model.layers.26.block_sparse_moe.experts.7.w2
  model.layers.26.block_sparse_moe.experts.7.w3
  model.layers.26.block_sparse_moe.experts.7.act_fn
  model.layers.26.input_layernorm
  model.layers.26.post_attention_layernorm
  model.layers.27
  model.layers.27.self_attn
  model.layers.27.self_attn.q_proj
  model.layers.27.self_attn.k_proj
  model.layers.27.self_attn.v_proj
  model.layers.27.self_attn.o_proj
  model.layers.27.self_attn.rotary_emb
  model.layers.27.block_sparse_moe
  model.layers.27.block_sparse_moe.gate
  model.layers.27.block_sparse_moe.experts
  model.layers.27.block_sparse_moe.experts.0
  model.layers.27.block_sparse_moe.experts.0.w1
  model.layers.27.block_sparse_moe.experts.0.w2
  model.layers.27.block_sparse_moe.experts.0.w3
  model.layers.27.block_sparse_moe.experts.0.act_fn
  model.layers.27.block_sparse_moe.experts.1
  model.layers.27.block_sparse_moe.experts.1.w1
  model.layers.27.block_sparse_moe.experts.1.w2
  model.layers.27.block_sparse_moe.experts.1.w3
  model.layers.27.block_sparse_moe.experts.1.act_fn
  model.layers.27.block_sparse_moe.experts.2
  model.layers.27.block_sparse_moe.experts.2.w1
  model.layers.27.block_sparse_moe.experts.2.w2
  model.layers.27.block_sparse_moe.experts.2.w3
  model.layers.27.block_sparse_moe.experts.2.act_fn
  model.layers.27.block_sparse_moe.experts.3
  model.layers.27.block_sparse_moe.experts.3.w1
  model.layers.27.block_sparse_moe.experts.3.w2
  model.layers.27.block_sparse_moe.experts.3.w3
  model.layers.27.block_sparse_moe.experts.3.act_fn
  model.layers.27.block_sparse_moe.experts.4
  model.layers.27.block_sparse_moe.experts.4.w1
  model.layers.27.block_sparse_moe.experts.4.w2
  model.layers.27.block_sparse_moe.experts.4.w3
  model.layers.27.block_sparse_moe.experts.4.act_fn
  model.layers.27.block_sparse_moe.experts.5
  model.layers.27.block_sparse_moe.experts.5.w1
  model.layers.27.block_sparse_moe.experts.5.w2
  model.layers.27.block_sparse_moe.experts.5.w3
  model.layers.27.block_sparse_moe.experts.5.act_fn
  model.layers.27.block_sparse_moe.experts.6
  model.layers.27.block_sparse_moe.experts.6.w1
  model.layers.27.block_sparse_moe.experts.6.w2
  model.layers.27.block_sparse_moe.experts.6.w3
  model.layers.27.block_sparse_moe.experts.6.act_fn
  model.layers.27.block_sparse_moe.experts.7
  model.layers.27.block_sparse_moe.experts.7.w1
  model.layers.27.block_sparse_moe.experts.7.w2
  model.layers.27.block_sparse_moe.experts.7.w3
  model.layers.27.block_sparse_moe.experts.7.act_fn
  model.layers.27.input_layernorm
  model.layers.27.post_attention_layernorm
  model.layers.28
  model.layers.28.self_attn
  model.layers.28.self_attn.q_proj
  model.layers.28.self_attn.k_proj
  model.layers.28.self_attn.v_proj
  model.layers.28.self_attn.o_proj
  model.layers.28.self_attn.rotary_emb
  model.layers.28.block_sparse_moe
  model.layers.28.block_sparse_moe.gate
  model.layers.28.block_sparse_moe.experts
  model.layers.28.block_sparse_moe.experts.0
  model.layers.28.block_sparse_moe.experts.0.w1
  model.layers.28.block_sparse_moe.experts.0.w2
  model.layers.28.block_sparse_moe.experts.0.w3
  model.layers.28.block_sparse_moe.experts.0.act_fn
  model.layers.28.block_sparse_moe.experts.1
  model.layers.28.block_sparse_moe.experts.1.w1
  model.layers.28.block_sparse_moe.experts.1.w2
  model.layers.28.block_sparse_moe.experts.1.w3
  model.layers.28.block_sparse_moe.experts.1.act_fn
  model.layers.28.block_sparse_moe.experts.2
  model.layers.28.block_sparse_moe.experts.2.w1
  model.layers.28.block_sparse_moe.experts.2.w2
  model.layers.28.block_sparse_moe.experts.2.w3
  model.layers.28.block_sparse_moe.experts.2.act_fn
  model.layers.28.block_sparse_moe.experts.3
  model.layers.28.block_sparse_moe.experts.3.w1
  model.layers.28.block_sparse_moe.experts.3.w2
  model.layers.28.block_sparse_moe.experts.3.w3
  model.layers.28.block_sparse_moe.experts.3.act_fn
  model.layers.28.block_sparse_moe.experts.4
  model.layers.28.block_sparse_moe.experts.4.w1
  model.layers.28.block_sparse_moe.experts.4.w2
  model.layers.28.block_sparse_moe.experts.4.w3
  model.layers.28.block_sparse_moe.experts.4.act_fn
  model.layers.28.block_sparse_moe.experts.5
  model.layers.28.block_sparse_moe.experts.5.w1
  model.layers.28.block_sparse_moe.experts.5.w2
  model.layers.28.block_sparse_moe.experts.5.w3
  model.layers.28.block_sparse_moe.experts.5.act_fn
  model.layers.28.block_sparse_moe.experts.6
  model.layers.28.block_sparse_moe.experts.6.w1
  model.layers.28.block_sparse_moe.experts.6.w2
  model.layers.28.block_sparse_moe.experts.6.w3
  model.layers.28.block_sparse_moe.experts.6.act_fn
  model.layers.28.block_sparse_moe.experts.7
  model.layers.28.block_sparse_moe.experts.7.w1
  model.layers.28.block_sparse_moe.experts.7.w2
  model.layers.28.block_sparse_moe.experts.7.w3
  model.layers.28.block_sparse_moe.experts.7.act_fn
  model.layers.28.input_layernorm
  model.layers.28.post_attention_layernorm
  model.layers.29
  model.layers.29.self_attn
  model.layers.29.self_attn.q_proj
  model.layers.29.self_attn.k_proj
  model.layers.29.self_attn.v_proj
  model.layers.29.self_attn.o_proj
  model.layers.29.self_attn.rotary_emb
  model.layers.29.block_sparse_moe
  model.layers.29.block_sparse_moe.gate
  model.layers.29.block_sparse_moe.experts
  model.layers.29.block_sparse_moe.experts.0
  model.layers.29.block_sparse_moe.experts.0.w1
  model.layers.29.block_sparse_moe.experts.0.w2
  model.layers.29.block_sparse_moe.experts.0.w3
  model.layers.29.block_sparse_moe.experts.0.act_fn
  model.layers.29.block_sparse_moe.experts.1
  model.layers.29.block_sparse_moe.experts.1.w1
  model.layers.29.block_sparse_moe.experts.1.w2
  model.layers.29.block_sparse_moe.experts.1.w3
  model.layers.29.block_sparse_moe.experts.1.act_fn
  model.layers.29.block_sparse_moe.experts.2
  model.layers.29.block_sparse_moe.experts.2.w1
  model.layers.29.block_sparse_moe.experts.2.w2
  model.layers.29.block_sparse_moe.experts.2.w3
  model.layers.29.block_sparse_moe.experts.2.act_fn
  model.layers.29.block_sparse_moe.experts.3
  model.layers.29.block_sparse_moe.experts.3.w1
  model.layers.29.block_sparse_moe.experts.3.w2
  model.layers.29.block_sparse_moe.experts.3.w3
  model.layers.29.block_sparse_moe.experts.3.act_fn
  model.layers.29.block_sparse_moe.experts.4
  model.layers.29.block_sparse_moe.experts.4.w1
  model.layers.29.block_sparse_moe.experts.4.w2
  model.layers.29.block_sparse_moe.experts.4.w3
  model.layers.29.block_sparse_moe.experts.4.act_fn
  model.layers.29.block_sparse_moe.experts.5
  model.layers.29.block_sparse_moe.experts.5.w1
  model.layers.29.block_sparse_moe.experts.5.w2
  model.layers.29.block_sparse_moe.experts.5.w3
  model.layers.29.block_sparse_moe.experts.5.act_fn
  model.layers.29.block_sparse_moe.experts.6
  model.layers.29.block_sparse_moe.experts.6.w1
  model.layers.29.block_sparse_moe.experts.6.w2
  model.layers.29.block_sparse_moe.experts.6.w3
  model.layers.29.block_sparse_moe.experts.6.act_fn
  model.layers.29.block_sparse_moe.experts.7
  model.layers.29.block_sparse_moe.experts.7.w1
  model.layers.29.block_sparse_moe.experts.7.w2
  model.layers.29.block_sparse_moe.experts.7.w3
  model.layers.29.block_sparse_moe.experts.7.act_fn
  model.layers.29.input_layernorm
  model.layers.29.post_attention_layernorm
  model.layers.30
  model.layers.30.self_attn
  model.layers.30.self_attn.q_proj
  model.layers.30.self_attn.k_proj
  model.layers.30.self_attn.v_proj
  model.layers.30.self_attn.o_proj
  model.layers.30.self_attn.rotary_emb
  model.layers.30.block_sparse_moe
  model.layers.30.block_sparse_moe.gate
  model.layers.30.block_sparse_moe.experts
  model.layers.30.block_sparse_moe.experts.0
  model.layers.30.block_sparse_moe.experts.0.w1
  model.layers.30.block_sparse_moe.experts.0.w2
  model.layers.30.block_sparse_moe.experts.0.w3
  model.layers.30.block_sparse_moe.experts.0.act_fn
  model.layers.30.block_sparse_moe.experts.1
  model.layers.30.block_sparse_moe.experts.1.w1
  model.layers.30.block_sparse_moe.experts.1.w2
  model.layers.30.block_sparse_moe.experts.1.w3
  model.layers.30.block_sparse_moe.experts.1.act_fn
  model.layers.30.block_sparse_moe.experts.2
  model.layers.30.block_sparse_moe.experts.2.w1
  model.layers.30.block_sparse_moe.experts.2.w2
  model.layers.30.block_sparse_moe.experts.2.w3
  model.layers.30.block_sparse_moe.experts.2.act_fn
  model.layers.30.block_sparse_moe.experts.3
  model.layers.30.block_sparse_moe.experts.3.w1
  model.layers.30.block_sparse_moe.experts.3.w2
  model.layers.30.block_sparse_moe.experts.3.w3
  model.layers.30.block_sparse_moe.experts.3.act_fn
  model.layers.30.block_sparse_moe.experts.4
  model.layers.30.block_sparse_moe.experts.4.w1
  model.layers.30.block_sparse_moe.experts.4.w2
  model.layers.30.block_sparse_moe.experts.4.w3
  model.layers.30.block_sparse_moe.experts.4.act_fn
  model.layers.30.block_sparse_moe.experts.5
  model.layers.30.block_sparse_moe.experts.5.w1
  model.layers.30.block_sparse_moe.experts.5.w2
  model.layers.30.block_sparse_moe.experts.5.w3
  model.layers.30.block_sparse_moe.experts.5.act_fn
  model.layers.30.block_sparse_moe.experts.6
  model.layers.30.block_sparse_moe.experts.6.w1
  model.layers.30.block_sparse_moe.experts.6.w2
  model.layers.30.block_sparse_moe.experts.6.w3
  model.layers.30.block_sparse_moe.experts.6.act_fn
  model.layers.30.block_sparse_moe.experts.7
  model.layers.30.block_sparse_moe.experts.7.w1
  model.layers.30.block_sparse_moe.experts.7.w2
  model.layers.30.block_sparse_moe.experts.7.w3
  model.layers.30.block_sparse_moe.experts.7.act_fn
  model.layers.30.input_layernorm
  model.layers.30.post_attention_layernorm
  model.layers.31
  model.layers.31.self_attn
  model.layers.31.self_attn.q_proj
  model.layers.31.self_attn.k_proj
  model.layers.31.self_attn.v_proj
  model.layers.31.self_attn.o_proj
  model.layers.31.self_attn.rotary_emb
  model.layers.31.block_sparse_moe
  model.layers.31.block_sparse_moe.gate
  model.layers.31.block_sparse_moe.experts
  model.layers.31.block_sparse_moe.experts.0
  model.layers.31.block_sparse_moe.experts.0.w1
  model.layers.31.block_sparse_moe.experts.0.w2
  model.layers.31.block_sparse_moe.experts.0.w3
  model.layers.31.block_sparse_moe.experts.0.act_fn
  model.layers.31.block_sparse_moe.experts.1
  model.layers.31.block_sparse_moe.experts.1.w1
  model.layers.31.block_sparse_moe.experts.1.w2
  model.layers.31.block_sparse_moe.experts.1.w3
  model.layers.31.block_sparse_moe.experts.1.act_fn
  model.layers.31.block_sparse_moe.experts.2
  model.layers.31.block_sparse_moe.experts.2.w1
  model.layers.31.block_sparse_moe.experts.2.w2
  model.layers.31.block_sparse_moe.experts.2.w3
  model.layers.31.block_sparse_moe.experts.2.act_fn
  model.layers.31.block_sparse_moe.experts.3
  model.layers.31.block_sparse_moe.experts.3.w1
  model.layers.31.block_sparse_moe.experts.3.w2
  model.layers.31.block_sparse_moe.experts.3.w3
  model.layers.31.block_sparse_moe.experts.3.act_fn
  model.layers.31.block_sparse_moe.experts.4
  model.layers.31.block_sparse_moe.experts.4.w1
  model.layers.31.block_sparse_moe.experts.4.w2
  model.layers.31.block_sparse_moe.experts.4.w3
  model.layers.31.block_sparse_moe.experts.4.act_fn
  model.layers.31.block_sparse_moe.experts.5
  model.layers.31.block_sparse_moe.experts.5.w1
  model.layers.31.block_sparse_moe.experts.5.w2
  model.layers.31.block_sparse_moe.experts.5.w3
  model.layers.31.block_sparse_moe.experts.5.act_fn
  model.layers.31.block_sparse_moe.experts.6
  model.layers.31.block_sparse_moe.experts.6.w1
  model.layers.31.block_sparse_moe.experts.6.w2
  model.layers.31.block_sparse_moe.experts.6.w3
  model.layers.31.block_sparse_moe.experts.6.act_fn
  model.layers.31.block_sparse_moe.experts.7
  model.layers.31.block_sparse_moe.experts.7.w1
  model.layers.31.block_sparse_moe.experts.7.w2
  model.layers.31.block_sparse_moe.experts.7.w3
  model.layers.31.block_sparse_moe.experts.7.act_fn
  model.layers.31.input_layernorm
  model.layers.31.post_attention_layernorm
  model.norm
  lm_head
[main] 模型加载完成！

[main] 初始化: 仅把5~31层的 Experts (w1,w2,w3) => CPU, 保留 Gate/LN 在 GPU
[move_expert_weights_to_device] model.layers.5.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.5.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.5.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.5.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.5.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.5.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.5.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.5.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.7.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.7.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.7.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.7.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.7.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.7.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.7.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.7.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.8.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.8.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.8.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.8.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.8.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.8.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.8.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.8.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.9.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.9.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.9.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.9.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.9.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.9.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.9.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.9.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.10.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.10.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.10.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.10.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.10.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.10.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.10.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.10.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.11.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.11.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.11.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.11.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.11.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.11.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.11.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.11.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.12.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.12.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.12.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.12.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.12.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.12.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.12.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.12.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.13.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.13.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.13.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.13.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.13.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.13.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.13.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.13.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.14.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.14.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.14.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.14.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.14.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.14.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.14.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.14.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.15.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.15.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.15.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.15.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.15.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.15.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.15.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.15.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.16.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.16.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.16.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.16.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.16.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.16.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.16.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.16.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.17.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.17.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.17.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.17.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.17.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.17.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.17.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.17.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.18.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.18.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.18.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.18.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.18.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.18.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.18.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.18.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.19.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.19.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.19.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.19.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.19.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.19.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.19.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.19.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.20.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.20.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.20.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.20.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.20.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.20.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.20.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.20.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.21.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.21.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.21.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.21.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.21.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.21.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.21.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.21.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.22.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.22.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.22.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.22.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.22.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.22.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.22.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.22.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.23.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.23.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.23.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.23.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.23.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.23.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.23.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.23.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.24.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.24.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.24.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.24.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.24.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.24.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.24.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.24.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.25.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.25.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.25.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.25.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.25.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.25.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.25.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.25.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.26.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.26.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.26.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.26.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.26.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.26.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.26.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.26.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.27.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.27.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.27.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.27.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.27.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.27.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.27.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.27.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.28.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.28.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.28.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.28.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.28.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.28.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.28.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.28.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.29.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.29.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.29.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.29.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.29.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.29.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.29.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.29.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.30.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.30.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.30.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.30.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.30.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.30.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.30.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.30.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.31.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.31.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.31.block_sparse_moe.experts.2 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.31.block_sparse_moe.experts.3 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.31.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.31.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.31.block_sparse_moe.experts.6 的 w1/w2/w3 => cpu
[move_expert_weights_to_device] model.layers.31.block_sparse_moe.experts.7 的 w1/w2/w3 => cpu
[main] 初始化完成, 开始处理请求...

[main] 第 1/11 个请求: What is artificial intelligence? It's about machine reasoning.
[main] GPU已满, swap out idle (3, 5)
[move_expert_weights_to_device] model.layers.3.block_sparse_moe.experts.5 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(3, 5) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 1) => GPU(w1,w2,w3)
[main] GPU已满, swap out idle (0, 4)
[move_expert_weights_to_device] model.layers.0.block_sparse_moe.experts.4 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(0, 4) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 0) => GPU(w1,w2,w3)
the 0-th expert, it's topx is tensor([ 5, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 11,  9], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 1, 3, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 6], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 9, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 0,  6, 10], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1, 4, 8, 9, 7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 3,  0,  4,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11, 12,  1,  5], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3, 10, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6,  7, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1, 11,  4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7, 1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([5, 0, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([9], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  4,  5,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  5, 12,  4,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 4, 11,  3, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([10,  1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([0, 3, 9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 6,  9,  0,  8, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  2,  0,  7, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 12,  5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  8, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5,  8,  6, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 7-th expert, it's topx is tensor([ 4,  6,  7,  9, 11,  1,  2,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 8, 9, 3, 7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([3, 7, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 4,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([12,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([ 6, 11,  1,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 0,  5, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 4, 10,  0, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([ 7,  4,  9, 10, 11, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 5, 8], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 0, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 3, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([ 1,  4, 10,  3,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([6, 9, 5, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([ 1,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([ 2,  3,  4, 10,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([ 9,  8, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 7,  0,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([ 5,  6, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([1, 3, 9], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([ 3,  6, 10, 12,  1,  4,  5,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([11,  3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([ 8,  0,  6, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 2,  5,  9,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([4, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([0, 1, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([3, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([0], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([10, 11,  3,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 2,  5, 12, 10, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([ 6,  7,  0,  2,  5,  8,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([0, 8, 9, 1, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([ 1,  5,  6,  7, 12,  8], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([ 4, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([8, 1, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 3, 10,  0,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([9, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([11, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([2, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([8, 2, 5, 7, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([ 6, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 3,  7, 10,  1,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([12,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 0,  4, 11,  3], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([2, 5, 9, 0, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 1, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([1, 4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 3, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 2,  5,  6,  7, 12,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 4,  9, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([0, 8, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([2, 7, 3], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([0, 6, 8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([12,  1,  5,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 1, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([ 3,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 5,  4,  8, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([ 5, 12, 11], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 1,  2,  7,  4, 10], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([ 8,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 9, 10,  0,  3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([3, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([0, 2, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([0], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([2, 3, 1, 4, 6, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 1,  5,  7,  8,  2, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([ 0,  6, 10,  5], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 3,  9, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([9, 0], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 4, 11, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([ 0,  4, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([ 1,  3, 10, 11,  0,  4,  6], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([1, 9], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 2,  5,  8,  9, 12,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([ 5,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([7, 2, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([11,  4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 3,  4,  6, 11, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([ 5,  8, 12,  2,  6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 0, 10,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 2,  0,  1,  5,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([ 1, 12], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([ 5, 12,  2,  3,  7], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 0,  1,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([0], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([11,  4, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 2,  8, 10,  5,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([9, 0, 6, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 2,  3,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 6,  0,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([11,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([0, 3, 8, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 5, 10, 12,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([ 0,  8,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 5,  6,  7,  9, 10,  1,  3,  4,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 1,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([12,  6,  7,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 2,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([0, 1, 2], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([ 7, 10,  3,  5,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 0, 12,  8], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([1, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 3, 11,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([ 2,  6,  8,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([ 3,  9,  8, 10, 11, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([10,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([1, 8, 4, 6], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([ 6,  7, 11,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 0,  5, 12,  2,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([2, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([ 9, 11,  1,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([1, 3, 7, 2, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 0,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([7, 8], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 8, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([4, 5, 6], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 2, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([3, 8, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 4, 11,  1,  3,  6], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 2, 10,  7,  8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([ 1,  5,  7, 12,  2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 0,  5, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([ 0, 10], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 9, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([ 0,  4,  5, 12,  1,  2,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 7,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([9, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([2, 8, 6, 9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([11,  0, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 1,  3, 10,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([2, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([8, 0, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([6, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 3,  5, 10, 12,  7, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 8, 10, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([1, 2, 4, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([ 7,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([6, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 9, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([3, 0, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 8, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([11,  7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 0,  5, 12,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([ 3,  4,  2,  5, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([0, 1, 6, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 5, 12,  7,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([11,  0,  4], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([2, 8, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([10,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([8], device='cuda:0'), idx is tensor([1], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([ 4,  7, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 0,  2, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([ 2,  9,  0,  1,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([ 5, 12,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([1, 6, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([3, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([ 5, 12], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([8, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 1,  4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 3,  9,  2, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([ 0,  2,  1,  5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([ 0,  4, 11], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([10,  3,  7], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
the 0-th expert, it's topx is tensor([ 4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
The 0-th expert is used but on CPU device
the 1-th expert, it's topx is tensor([10], device='cuda:0'), idx is tensor([0], device='cuda:0')
The 1-th expert is used but on CPU device
the 2-th expert, it's topx is tensor([ 0,  2,  5, 12], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
The 2-th expert is used but on CPU device
the 3-th expert, it's topx is tensor([ 3,  1,  4,  8,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
The 3-th expert is used but on CPU device
the 4-th expert, it's topx is tensor([11], device='cuda:0'), idx is tensor([1], device='cuda:0')
The 4-th expert is used but on CPU device
the 5-th expert, it's topx is tensor([7, 3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
The 5-th expert is used but on CPU device
the 6-th expert, it's topx is tensor([1, 8, 9, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
The 6-th expert is used but on CPU device
the 7-th expert, it's topx is tensor([ 0,  2,  5,  7, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1, 1], device='cuda:0')
The 7-th expert is used but on CPU device
[main] MoE层时间(假设): 2.5319s, 总推理: 5.0637s
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 1) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 0) => CPU(w1,w2,w3)

[main] 第 2/11 个请求: What is artificial intelligence? It's about machine reasoning.
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 1) => GPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 0) => GPU(w1,w2,w3)
the 0-th expert, it's topx is tensor([ 5, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 11,  9], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 1, 3, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 6], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 9, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  6, 10], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1, 4, 8, 9, 7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 3,  0,  4,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11, 12,  1,  5], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3, 10, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6,  7, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1, 11,  4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7, 1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([5, 0, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([9], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  4,  5,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  5, 12,  4,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 4, 11,  3, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([10,  1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 6,  9,  0,  8, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  2,  0,  7, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 12,  5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  8, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5,  8,  6, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 7-th expert, it's topx is tensor([ 4,  6,  7,  9, 11,  1,  2,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 8, 9, 3, 7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([3, 7, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([12,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6, 11,  1,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 10,  0, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 7,  4,  9, 10, 11, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 5, 8], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 1,  4, 10,  3,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 9, 5, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 2,  3,  4, 10,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 9,  8, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 7,  0,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  6, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([1, 3, 9], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  6, 10, 12,  1,  4,  5,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([11,  3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  0,  6, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  9,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 1, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  3,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5, 12, 10, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 6,  7,  0,  2,  5,  8,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 9, 1, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  5,  6,  7, 12,  8], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 1, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3, 10,  0,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([9, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([2, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8, 2, 5, 7, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  7, 10,  1,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 4-th expert, it's topx is tensor([12,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  4, 11,  3], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 5, 9, 0, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2,  5,  6,  7, 12,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 4,  9, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 3], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 6, 8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([12,  1,  5,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 1, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5,  4,  8, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12, 11], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  2,  7,  4, 10], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 9, 10,  0,  3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([3, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 2, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([2, 3, 1, 4, 6, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  5,  7,  8,  2, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  6, 10,  5], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  9, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 11, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  4, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 1,  3, 10, 11,  0,  4,  6], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([1, 9], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  8,  9, 12,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([11,  4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  4,  6, 11, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 5,  8, 12,  2,  6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0, 10,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  0,  1,  5,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1, 12], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 5, 12,  2,  3,  7], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  1,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  4, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  8, 10,  5,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0, 6, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 2,  3,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 6,  0,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 8, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5, 10, 12,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  8,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([ 5,  6,  7,  9, 10,  1,  3,  4,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([12,  6,  7,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([0, 1, 2], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7, 10,  3,  5,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0, 12,  8], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 11,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 2,  6,  8,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 0-th expert, it's topx is tensor([ 3,  9,  8, 10, 11, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([10,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 8, 4, 6], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6,  7, 11,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 12,  2,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 0-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 1-th expert, it's topx is tensor([ 9, 11,  1,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([1, 3, 7, 2, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 8], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 5, 6], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 8, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4, 11,  1,  3,  6], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2, 10,  7,  8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 1,  5,  7, 12,  2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0, 10], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 9, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 12,  1,  2,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 7,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([9, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 5-th expert, it's topx is tensor([2, 8, 6, 9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  0, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1,  3, 10,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 0, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([6, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  5, 10, 12,  7, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 8, 10, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 2, 4, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 9, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([3, 0, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  5, 12,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  4,  2,  5, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([0, 1, 6, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 5, 12,  7,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  0,  4], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4,  7, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  2, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 2,  9,  0,  1,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5, 12,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 6, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([3, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([8, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  9,  2, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  2,  1,  5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0,  4, 11], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  3,  7], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([10], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  2,  5, 12], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  1,  4,  8,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([7, 3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 8, 9, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  2,  5,  7, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1, 1], device='cuda:0')
[main] MoE层时间(假设): 0.2274s, 总推理: 0.4548s
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 1) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 0) => CPU(w1,w2,w3)

[main] 第 3/11 个请求: What is artificial intelligence? It's about machine reasoning.
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 1) => GPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 0) => GPU(w1,w2,w3)
the 0-th expert, it's topx is tensor([ 5, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 11,  9], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 1, 3, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 6], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 9, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  6, 10], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1, 4, 8, 9, 7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 3,  0,  4,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11, 12,  1,  5], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3, 10, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6,  7, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1, 11,  4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7, 1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([5, 0, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([9], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  4,  5,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  5, 12,  4,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 4, 11,  3, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([10,  1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 6,  9,  0,  8, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  2,  0,  7, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 12,  5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  8, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5,  8,  6, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 7-th expert, it's topx is tensor([ 4,  6,  7,  9, 11,  1,  2,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 8, 9, 3, 7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([3, 7, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([12,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6, 11,  1,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 10,  0, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 7,  4,  9, 10, 11, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 5, 8], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 1,  4, 10,  3,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 9, 5, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 2,  3,  4, 10,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 9,  8, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 7,  0,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  6, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([1, 3, 9], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  6, 10, 12,  1,  4,  5,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([11,  3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  0,  6, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  9,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 1, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  3,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5, 12, 10, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 6,  7,  0,  2,  5,  8,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 9, 1, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  5,  6,  7, 12,  8], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 1, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3, 10,  0,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([9, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([2, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8, 2, 5, 7, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  7, 10,  1,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 4-th expert, it's topx is tensor([12,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  4, 11,  3], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 5, 9, 0, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2,  5,  6,  7, 12,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 4,  9, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 3], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 6, 8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([12,  1,  5,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 1, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5,  4,  8, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12, 11], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  2,  7,  4, 10], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 9, 10,  0,  3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([3, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 2, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([2, 3, 1, 4, 6, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  5,  7,  8,  2, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  6, 10,  5], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  9, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 11, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  4, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 1,  3, 10, 11,  0,  4,  6], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([1, 9], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  8,  9, 12,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([11,  4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  4,  6, 11, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 5,  8, 12,  2,  6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0, 10,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  0,  1,  5,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1, 12], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 5, 12,  2,  3,  7], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  1,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  4, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  8, 10,  5,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0, 6, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 2,  3,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 6,  0,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 8, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5, 10, 12,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  8,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([ 5,  6,  7,  9, 10,  1,  3,  4,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([12,  6,  7,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([0, 1, 2], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7, 10,  3,  5,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0, 12,  8], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 11,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 2,  6,  8,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 0-th expert, it's topx is tensor([ 3,  9,  8, 10, 11, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([10,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 8, 4, 6], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6,  7, 11,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 12,  2,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 0-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 1-th expert, it's topx is tensor([ 9, 11,  1,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([1, 3, 7, 2, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 8], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 5, 6], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 8, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4, 11,  1,  3,  6], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2, 10,  7,  8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 1,  5,  7, 12,  2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0, 10], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 9, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 12,  1,  2,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 7,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([9, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 5-th expert, it's topx is tensor([2, 8, 6, 9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  0, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1,  3, 10,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 0, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([6, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  5, 10, 12,  7, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 8, 10, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 2, 4, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 9, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([3, 0, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  5, 12,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  4,  2,  5, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([0, 1, 6, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 5, 12,  7,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  0,  4], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4,  7, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  2, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 2,  9,  0,  1,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5, 12,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 6, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([3, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([8, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  9,  2, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  2,  1,  5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0,  4, 11], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  3,  7], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([10], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  2,  5, 12], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  1,  4,  8,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([7, 3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 8, 9, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  2,  5,  7, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1, 1], device='cuda:0')
[main] MoE层时间(假设): 0.2232s, 总推理: 0.4464s
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 1) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 0) => CPU(w1,w2,w3)

[main] 第 4/11 个请求: What is artificial intelligence? It's about machine reasoning.
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 1) => GPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 0) => GPU(w1,w2,w3)
the 0-th expert, it's topx is tensor([ 5, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 11,  9], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 1, 3, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 6], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 9, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  6, 10], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1, 4, 8, 9, 7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 3,  0,  4,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11, 12,  1,  5], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3, 10, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6,  7, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1, 11,  4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7, 1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([5, 0, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([9], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  4,  5,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  5, 12,  4,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 4, 11,  3, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([10,  1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 6,  9,  0,  8, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  2,  0,  7, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 12,  5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  8, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5,  8,  6, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 7-th expert, it's topx is tensor([ 4,  6,  7,  9, 11,  1,  2,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 8, 9, 3, 7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([3, 7, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([12,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6, 11,  1,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 10,  0, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 7,  4,  9, 10, 11, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 5, 8], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 1,  4, 10,  3,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 9, 5, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 2,  3,  4, 10,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 9,  8, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 7,  0,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  6, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([1, 3, 9], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  6, 10, 12,  1,  4,  5,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([11,  3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  0,  6, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  9,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 1, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  3,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5, 12, 10, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 6,  7,  0,  2,  5,  8,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 9, 1, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  5,  6,  7, 12,  8], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 1, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3, 10,  0,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([9, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([2, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8, 2, 5, 7, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  7, 10,  1,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 4-th expert, it's topx is tensor([12,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  4, 11,  3], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 5, 9, 0, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2,  5,  6,  7, 12,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 4,  9, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 3], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 6, 8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([12,  1,  5,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 1, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5,  4,  8, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12, 11], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  2,  7,  4, 10], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 9, 10,  0,  3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([3, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 2, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([2, 3, 1, 4, 6, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  5,  7,  8,  2, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  6, 10,  5], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  9, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 11, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  4, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 1,  3, 10, 11,  0,  4,  6], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([1, 9], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  8,  9, 12,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([11,  4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  4,  6, 11, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 5,  8, 12,  2,  6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0, 10,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  0,  1,  5,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1, 12], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 5, 12,  2,  3,  7], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  1,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  4, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  8, 10,  5,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0, 6, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 2,  3,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 6,  0,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 8, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5, 10, 12,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  8,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([ 5,  6,  7,  9, 10,  1,  3,  4,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([12,  6,  7,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([0, 1, 2], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7, 10,  3,  5,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0, 12,  8], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 11,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 2,  6,  8,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 0-th expert, it's topx is tensor([ 3,  9,  8, 10, 11, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([10,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 8, 4, 6], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6,  7, 11,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 12,  2,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 0-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 1-th expert, it's topx is tensor([ 9, 11,  1,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([1, 3, 7, 2, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 8], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 5, 6], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 8, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4, 11,  1,  3,  6], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2, 10,  7,  8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 1,  5,  7, 12,  2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0, 10], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 9, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 12,  1,  2,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 7,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([9, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 5-th expert, it's topx is tensor([2, 8, 6, 9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  0, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1,  3, 10,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 0, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([6, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  5, 10, 12,  7, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 8, 10, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 2, 4, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 9, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([3, 0, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  5, 12,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  4,  2,  5, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([0, 1, 6, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 5, 12,  7,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  0,  4], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4,  7, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  2, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 2,  9,  0,  1,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5, 12,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 6, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([3, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([8, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  9,  2, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  2,  1,  5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0,  4, 11], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  3,  7], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([10], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  2,  5, 12], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  1,  4,  8,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([7, 3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 8, 9, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  2,  5,  7, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1, 1], device='cuda:0')
[main] MoE层时间(假设): 0.2221s, 总推理: 0.4442s
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 1) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 0) => CPU(w1,w2,w3)

[main] 第 5/11 个请求: What is artificial intelligence? It's about machine reasoning.
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 1) => GPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 0) => GPU(w1,w2,w3)
the 0-th expert, it's topx is tensor([ 5, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 11,  9], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 1, 3, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 6], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 9, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  6, 10], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1, 4, 8, 9, 7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 3,  0,  4,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11, 12,  1,  5], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3, 10, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6,  7, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1, 11,  4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7, 1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([5, 0, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([9], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  4,  5,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  5, 12,  4,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 4, 11,  3, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([10,  1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 6,  9,  0,  8, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  2,  0,  7, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 12,  5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  8, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5,  8,  6, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 7-th expert, it's topx is tensor([ 4,  6,  7,  9, 11,  1,  2,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 8, 9, 3, 7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([3, 7, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([12,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6, 11,  1,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 10,  0, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 7,  4,  9, 10, 11, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 5, 8], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 1,  4, 10,  3,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 9, 5, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 2,  3,  4, 10,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 9,  8, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 7,  0,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  6, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([1, 3, 9], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  6, 10, 12,  1,  4,  5,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([11,  3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  0,  6, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  9,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 1, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  3,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5, 12, 10, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 6,  7,  0,  2,  5,  8,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 9, 1, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  5,  6,  7, 12,  8], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 1, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3, 10,  0,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([9, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([2, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8, 2, 5, 7, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  7, 10,  1,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 4-th expert, it's topx is tensor([12,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  4, 11,  3], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 5, 9, 0, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2,  5,  6,  7, 12,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 4,  9, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 3], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 6, 8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([12,  1,  5,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 1, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5,  4,  8, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12, 11], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  2,  7,  4, 10], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 9, 10,  0,  3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([3, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 2, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([2, 3, 1, 4, 6, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  5,  7,  8,  2, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  6, 10,  5], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  9, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 11, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  4, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 1,  3, 10, 11,  0,  4,  6], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([1, 9], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  8,  9, 12,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([11,  4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  4,  6, 11, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 5,  8, 12,  2,  6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0, 10,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  0,  1,  5,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1, 12], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 5, 12,  2,  3,  7], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  1,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  4, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  8, 10,  5,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0, 6, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 2,  3,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 6,  0,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 8, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5, 10, 12,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  8,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([ 5,  6,  7,  9, 10,  1,  3,  4,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([12,  6,  7,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([0, 1, 2], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7, 10,  3,  5,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0, 12,  8], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 11,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 2,  6,  8,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 0-th expert, it's topx is tensor([ 3,  9,  8, 10, 11, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([10,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 8, 4, 6], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6,  7, 11,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 12,  2,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 0-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 1-th expert, it's topx is tensor([ 9, 11,  1,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([1, 3, 7, 2, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 8], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 5, 6], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 8, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4, 11,  1,  3,  6], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2, 10,  7,  8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 1,  5,  7, 12,  2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0, 10], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 9, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 12,  1,  2,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 7,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([9, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 5-th expert, it's topx is tensor([2, 8, 6, 9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  0, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1,  3, 10,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 0, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([6, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  5, 10, 12,  7, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 8, 10, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 2, 4, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 9, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([3, 0, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  5, 12,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  4,  2,  5, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([0, 1, 6, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 5, 12,  7,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  0,  4], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4,  7, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  2, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 2,  9,  0,  1,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5, 12,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 6, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([3, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([8, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  9,  2, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  2,  1,  5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0,  4, 11], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  3,  7], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([10], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  2,  5, 12], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  1,  4,  8,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([7, 3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 8, 9, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  2,  5,  7, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1, 1], device='cuda:0')
[main] MoE层时间(假设): 0.2234s, 总推理: 0.4469s
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 1) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 0) => CPU(w1,w2,w3)

[main] 第 6/11 个请求: What is artificial intelligence? It's about machine reasoning.
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 1) => GPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 0) => GPU(w1,w2,w3)
the 0-th expert, it's topx is tensor([ 5, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 11,  9], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 1, 3, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 6], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 9, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  6, 10], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1, 4, 8, 9, 7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 3,  0,  4,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11, 12,  1,  5], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3, 10, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6,  7, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1, 11,  4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7, 1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([5, 0, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([9], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  4,  5,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  5, 12,  4,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 4, 11,  3, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([10,  1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 6,  9,  0,  8, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  2,  0,  7, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 12,  5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  8, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5,  8,  6, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 7-th expert, it's topx is tensor([ 4,  6,  7,  9, 11,  1,  2,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 8, 9, 3, 7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([3, 7, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([12,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6, 11,  1,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 10,  0, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 7,  4,  9, 10, 11, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 5, 8], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 1,  4, 10,  3,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 9, 5, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 2,  3,  4, 10,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 9,  8, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 7,  0,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  6, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([1, 3, 9], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  6, 10, 12,  1,  4,  5,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([11,  3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  0,  6, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  9,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 1, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  3,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5, 12, 10, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 6,  7,  0,  2,  5,  8,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 9, 1, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  5,  6,  7, 12,  8], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 1, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3, 10,  0,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([9, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([2, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8, 2, 5, 7, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  7, 10,  1,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 4-th expert, it's topx is tensor([12,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  4, 11,  3], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 5, 9, 0, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2,  5,  6,  7, 12,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 4,  9, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 3], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 6, 8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([12,  1,  5,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 1, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5,  4,  8, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12, 11], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  2,  7,  4, 10], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 9, 10,  0,  3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([3, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 2, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([2, 3, 1, 4, 6, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  5,  7,  8,  2, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  6, 10,  5], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  9, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 11, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  4, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 1,  3, 10, 11,  0,  4,  6], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([1, 9], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  8,  9, 12,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([11,  4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  4,  6, 11, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 5,  8, 12,  2,  6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0, 10,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  0,  1,  5,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1, 12], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 5, 12,  2,  3,  7], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  1,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  4, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  8, 10,  5,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0, 6, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 2,  3,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 6,  0,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 8, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5, 10, 12,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  8,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([ 5,  6,  7,  9, 10,  1,  3,  4,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([12,  6,  7,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([0, 1, 2], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7, 10,  3,  5,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0, 12,  8], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 11,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 2,  6,  8,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 0-th expert, it's topx is tensor([ 3,  9,  8, 10, 11, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([10,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 8, 4, 6], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6,  7, 11,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 12,  2,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 0-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 1-th expert, it's topx is tensor([ 9, 11,  1,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([1, 3, 7, 2, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 8], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 5, 6], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 8, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4, 11,  1,  3,  6], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2, 10,  7,  8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 1,  5,  7, 12,  2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0, 10], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 9, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 12,  1,  2,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 7,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([9, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 5-th expert, it's topx is tensor([2, 8, 6, 9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  0, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1,  3, 10,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 0, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([6, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  5, 10, 12,  7, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 8, 10, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 2, 4, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 9, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([3, 0, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  5, 12,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  4,  2,  5, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([0, 1, 6, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 5, 12,  7,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  0,  4], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4,  7, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  2, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 2,  9,  0,  1,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5, 12,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 6, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([3, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([8, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  9,  2, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  2,  1,  5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0,  4, 11], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  3,  7], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([10], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  2,  5, 12], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  1,  4,  8,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([7, 3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 8, 9, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  2,  5,  7, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1, 1], device='cuda:0')
[main] MoE层时间(假设): 0.2218s, 总推理: 0.4437s
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 1) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 0) => CPU(w1,w2,w3)

[main] 第 7/11 个请求: What is artificial intelligence? It's about machine reasoning.
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 1) => GPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 0) => GPU(w1,w2,w3)
the 0-th expert, it's topx is tensor([ 5, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 11,  9], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 1, 3, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 6], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 9, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  6, 10], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1, 4, 8, 9, 7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 3,  0,  4,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11, 12,  1,  5], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3, 10, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6,  7, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1, 11,  4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7, 1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([5, 0, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([9], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  4,  5,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  5, 12,  4,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 4, 11,  3, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([10,  1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 6,  9,  0,  8, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  2,  0,  7, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 12,  5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  8, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5,  8,  6, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 7-th expert, it's topx is tensor([ 4,  6,  7,  9, 11,  1,  2,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 8, 9, 3, 7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([3, 7, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([12,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6, 11,  1,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 10,  0, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 7,  4,  9, 10, 11, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 5, 8], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 1,  4, 10,  3,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 9, 5, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 2,  3,  4, 10,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 9,  8, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 7,  0,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  6, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([1, 3, 9], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  6, 10, 12,  1,  4,  5,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([11,  3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  0,  6, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  9,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 1, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  3,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5, 12, 10, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 6,  7,  0,  2,  5,  8,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 9, 1, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  5,  6,  7, 12,  8], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 1, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3, 10,  0,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([9, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([2, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8, 2, 5, 7, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  7, 10,  1,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 4-th expert, it's topx is tensor([12,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  4, 11,  3], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 5, 9, 0, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2,  5,  6,  7, 12,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 4,  9, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 3], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 6, 8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([12,  1,  5,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 1, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5,  4,  8, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12, 11], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  2,  7,  4, 10], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 9, 10,  0,  3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([3, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 2, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([2, 3, 1, 4, 6, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  5,  7,  8,  2, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  6, 10,  5], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  9, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 11, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  4, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 1,  3, 10, 11,  0,  4,  6], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([1, 9], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  8,  9, 12,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([11,  4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  4,  6, 11, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 5,  8, 12,  2,  6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0, 10,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  0,  1,  5,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1, 12], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 5, 12,  2,  3,  7], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  1,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  4, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  8, 10,  5,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0, 6, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 2,  3,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 6,  0,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 8, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5, 10, 12,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  8,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([ 5,  6,  7,  9, 10,  1,  3,  4,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([12,  6,  7,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([0, 1, 2], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7, 10,  3,  5,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0, 12,  8], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 11,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 2,  6,  8,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 0-th expert, it's topx is tensor([ 3,  9,  8, 10, 11, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([10,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 8, 4, 6], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6,  7, 11,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 12,  2,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 0-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 1-th expert, it's topx is tensor([ 9, 11,  1,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([1, 3, 7, 2, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 8], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 5, 6], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 8, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4, 11,  1,  3,  6], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2, 10,  7,  8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 1,  5,  7, 12,  2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0, 10], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 9, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 12,  1,  2,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 7,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([9, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 5-th expert, it's topx is tensor([2, 8, 6, 9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  0, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1,  3, 10,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 0, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([6, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  5, 10, 12,  7, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 8, 10, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 2, 4, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 9, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([3, 0, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  5, 12,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  4,  2,  5, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([0, 1, 6, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 5, 12,  7,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  0,  4], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4,  7, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  2, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 2,  9,  0,  1,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5, 12,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 6, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([3, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([8, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  9,  2, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  2,  1,  5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0,  4, 11], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  3,  7], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([10], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  2,  5, 12], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  1,  4,  8,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([7, 3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 8, 9, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  2,  5,  7, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1, 1], device='cuda:0')
[main] MoE层时间(假设): 0.2219s, 总推理: 0.4437s
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 1) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 0) => CPU(w1,w2,w3)

[main] 第 8/11 个请求: What is artificial intelligence? It's about machine reasoning.
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 1) => GPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 0) => GPU(w1,w2,w3)
the 0-th expert, it's topx is tensor([ 5, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 11,  9], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 1, 3, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 6], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 9, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  6, 10], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1, 4, 8, 9, 7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 3,  0,  4,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11, 12,  1,  5], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3, 10, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6,  7, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1, 11,  4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7, 1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([5, 0, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([9], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  4,  5,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  5, 12,  4,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 4, 11,  3, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([10,  1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 6,  9,  0,  8, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  2,  0,  7, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 12,  5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  8, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5,  8,  6, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 7-th expert, it's topx is tensor([ 4,  6,  7,  9, 11,  1,  2,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 8, 9, 3, 7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([3, 7, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([12,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6, 11,  1,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 10,  0, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 7,  4,  9, 10, 11, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 5, 8], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 1,  4, 10,  3,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 9, 5, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 2,  3,  4, 10,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 9,  8, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 7,  0,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  6, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([1, 3, 9], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  6, 10, 12,  1,  4,  5,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([11,  3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  0,  6, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  9,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 1, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  3,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5, 12, 10, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 6,  7,  0,  2,  5,  8,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 9, 1, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  5,  6,  7, 12,  8], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 1, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3, 10,  0,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([9, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([2, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8, 2, 5, 7, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  7, 10,  1,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 4-th expert, it's topx is tensor([12,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  4, 11,  3], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 5, 9, 0, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2,  5,  6,  7, 12,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 4,  9, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 3], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 6, 8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([12,  1,  5,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 1, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5,  4,  8, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12, 11], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  2,  7,  4, 10], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 9, 10,  0,  3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([3, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 2, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([2, 3, 1, 4, 6, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  5,  7,  8,  2, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  6, 10,  5], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  9, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 11, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  4, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 1,  3, 10, 11,  0,  4,  6], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([1, 9], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  8,  9, 12,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([11,  4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  4,  6, 11, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 5,  8, 12,  2,  6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0, 10,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  0,  1,  5,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1, 12], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 5, 12,  2,  3,  7], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  1,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  4, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  8, 10,  5,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0, 6, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 2,  3,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 6,  0,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 8, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5, 10, 12,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  8,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([ 5,  6,  7,  9, 10,  1,  3,  4,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([12,  6,  7,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([0, 1, 2], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7, 10,  3,  5,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0, 12,  8], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 11,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 2,  6,  8,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 0-th expert, it's topx is tensor([ 3,  9,  8, 10, 11, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([10,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 8, 4, 6], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6,  7, 11,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 12,  2,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 0-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 1-th expert, it's topx is tensor([ 9, 11,  1,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([1, 3, 7, 2, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 8], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 5, 6], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 8, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4, 11,  1,  3,  6], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2, 10,  7,  8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 1,  5,  7, 12,  2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0, 10], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 9, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 12,  1,  2,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 7,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([9, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 5-th expert, it's topx is tensor([2, 8, 6, 9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  0, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1,  3, 10,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 0, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([6, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  5, 10, 12,  7, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 8, 10, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 2, 4, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 9, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([3, 0, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  5, 12,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  4,  2,  5, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([0, 1, 6, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 5, 12,  7,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  0,  4], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4,  7, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  2, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 2,  9,  0,  1,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5, 12,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 6, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([3, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([8, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  9,  2, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  2,  1,  5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0,  4, 11], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  3,  7], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([10], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  2,  5, 12], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  1,  4,  8,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([7, 3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 8, 9, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  2,  5,  7, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1, 1], device='cuda:0')
[main] MoE层时间(假设): 0.2218s, 总推理: 0.4436s
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 1) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 0) => CPU(w1,w2,w3)

[main] 第 9/11 个请求: What is artificial intelligence? It's about machine reasoning.
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 1) => GPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 0) => GPU(w1,w2,w3)
the 0-th expert, it's topx is tensor([ 5, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 11,  9], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 1, 3, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 6], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 9, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  6, 10], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1, 4, 8, 9, 7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 3,  0,  4,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11, 12,  1,  5], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3, 10, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6,  7, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1, 11,  4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7, 1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([5, 0, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([9], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  4,  5,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  5, 12,  4,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 4, 11,  3, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([10,  1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 6,  9,  0,  8, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  2,  0,  7, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 12,  5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  8, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5,  8,  6, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 7-th expert, it's topx is tensor([ 4,  6,  7,  9, 11,  1,  2,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 8, 9, 3, 7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([3, 7, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([12,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6, 11,  1,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 10,  0, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 7,  4,  9, 10, 11, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 5, 8], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 1,  4, 10,  3,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 9, 5, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 2,  3,  4, 10,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 9,  8, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 7,  0,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  6, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([1, 3, 9], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  6, 10, 12,  1,  4,  5,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([11,  3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  0,  6, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  9,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 1, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  3,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5, 12, 10, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 6,  7,  0,  2,  5,  8,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 9, 1, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  5,  6,  7, 12,  8], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 1, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3, 10,  0,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([9, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([2, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8, 2, 5, 7, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  7, 10,  1,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 4-th expert, it's topx is tensor([12,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  4, 11,  3], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 5, 9, 0, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2,  5,  6,  7, 12,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 4,  9, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 3], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 6, 8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([12,  1,  5,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 1, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5,  4,  8, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12, 11], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  2,  7,  4, 10], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 9, 10,  0,  3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([3, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 2, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([2, 3, 1, 4, 6, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  5,  7,  8,  2, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  6, 10,  5], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  9, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 11, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  4, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 1,  3, 10, 11,  0,  4,  6], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([1, 9], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  8,  9, 12,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([11,  4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  4,  6, 11, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 5,  8, 12,  2,  6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0, 10,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  0,  1,  5,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1, 12], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 5, 12,  2,  3,  7], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  1,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  4, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  8, 10,  5,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0, 6, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 2,  3,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 6,  0,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 8, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5, 10, 12,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  8,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([ 5,  6,  7,  9, 10,  1,  3,  4,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([12,  6,  7,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([0, 1, 2], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7, 10,  3,  5,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0, 12,  8], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 11,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 2,  6,  8,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 0-th expert, it's topx is tensor([ 3,  9,  8, 10, 11, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([10,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 8, 4, 6], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6,  7, 11,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 12,  2,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 0-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 1-th expert, it's topx is tensor([ 9, 11,  1,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([1, 3, 7, 2, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 8], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 5, 6], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 8, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4, 11,  1,  3,  6], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2, 10,  7,  8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 1,  5,  7, 12,  2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0, 10], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 9, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 12,  1,  2,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 7,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([9, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 5-th expert, it's topx is tensor([2, 8, 6, 9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  0, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1,  3, 10,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 0, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([6, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  5, 10, 12,  7, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 8, 10, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 2, 4, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 9, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([3, 0, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  5, 12,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  4,  2,  5, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([0, 1, 6, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 5, 12,  7,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  0,  4], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4,  7, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  2, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 2,  9,  0,  1,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5, 12,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 6, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([3, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([8, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  9,  2, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  2,  1,  5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0,  4, 11], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  3,  7], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([10], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  2,  5, 12], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  1,  4,  8,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([7, 3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 8, 9, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  2,  5,  7, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1, 1], device='cuda:0')
[main] MoE层时间(假设): 0.2213s, 总推理: 0.4427s
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 1) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 0) => CPU(w1,w2,w3)

[main] 第 10/11 个请求: What is artificial intelligence? It's about machine reasoning.
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 1) => GPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 0) => GPU(w1,w2,w3)
the 0-th expert, it's topx is tensor([ 5, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 11,  9], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 1, 3, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 6], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 9, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  6, 10], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1, 4, 8, 9, 7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 3,  0,  4,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11, 12,  1,  5], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3, 10, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6,  7, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1, 11,  4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7, 1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([5, 0, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([9], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  4,  5,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  5, 12,  4,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 4, 11,  3, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([10,  1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 6,  9,  0,  8, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  2,  0,  7, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 12,  5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  8, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5,  8,  6, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 7-th expert, it's topx is tensor([ 4,  6,  7,  9, 11,  1,  2,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 8, 9, 3, 7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([3, 7, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([12,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6, 11,  1,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 10,  0, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 7,  4,  9, 10, 11, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 5, 8], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 1,  4, 10,  3,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 9, 5, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 2,  3,  4, 10,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 9,  8, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 7,  0,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  6, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([1, 3, 9], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  6, 10, 12,  1,  4,  5,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([11,  3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  0,  6, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  9,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 1, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  3,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5, 12, 10, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 6,  7,  0,  2,  5,  8,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 9, 1, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  5,  6,  7, 12,  8], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 1, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3, 10,  0,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([9, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([2, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8, 2, 5, 7, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  7, 10,  1,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 4-th expert, it's topx is tensor([12,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  4, 11,  3], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 5, 9, 0, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2,  5,  6,  7, 12,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 4,  9, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 3], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 6, 8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([12,  1,  5,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 1, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5,  4,  8, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12, 11], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  2,  7,  4, 10], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 9, 10,  0,  3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([3, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 2, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([2, 3, 1, 4, 6, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  5,  7,  8,  2, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  6, 10,  5], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  9, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 11, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  4, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 1,  3, 10, 11,  0,  4,  6], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([1, 9], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  8,  9, 12,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([11,  4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  4,  6, 11, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 5,  8, 12,  2,  6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0, 10,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  0,  1,  5,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1, 12], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 5, 12,  2,  3,  7], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  1,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  4, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  8, 10,  5,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0, 6, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 2,  3,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 6,  0,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 8, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5, 10, 12,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  8,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([ 5,  6,  7,  9, 10,  1,  3,  4,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([12,  6,  7,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([0, 1, 2], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7, 10,  3,  5,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0, 12,  8], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 11,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 2,  6,  8,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 0-th expert, it's topx is tensor([ 3,  9,  8, 10, 11, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([10,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 8, 4, 6], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6,  7, 11,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 12,  2,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 0-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 1-th expert, it's topx is tensor([ 9, 11,  1,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([1, 3, 7, 2, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 8], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 5, 6], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 8, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4, 11,  1,  3,  6], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2, 10,  7,  8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 1,  5,  7, 12,  2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0, 10], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 9, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 12,  1,  2,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 7,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([9, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 5-th expert, it's topx is tensor([2, 8, 6, 9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  0, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1,  3, 10,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 0, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([6, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  5, 10, 12,  7, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 8, 10, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 2, 4, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 9, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([3, 0, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  5, 12,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  4,  2,  5, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([0, 1, 6, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 5, 12,  7,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  0,  4], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4,  7, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  2, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 2,  9,  0,  1,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5, 12,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 6, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([3, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([8, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  9,  2, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  2,  1,  5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0,  4, 11], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  3,  7], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([10], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  2,  5, 12], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  1,  4,  8,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([7, 3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 8, 9, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  2,  5,  7, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1, 1], device='cuda:0')
[main] MoE层时间(假设): 0.2222s, 总推理: 0.4443s
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 1) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 0) => CPU(w1,w2,w3)

[main] 第 11/11 个请求: What is artificial intelligence? It's about machine reasoning.
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 1) => GPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cuda
[swap_in_expert] Expert(6, 0) => GPU(w1,w2,w3)
the 0-th expert, it's topx is tensor([ 5, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 11,  9], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 1, 3, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 6], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 9, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  6, 10], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1, 4, 8, 9, 7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 3,  0,  4,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11, 12,  1,  5], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3, 10, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6,  7, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1, 11,  4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7, 1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([5, 0, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([9], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  4,  5,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  5, 12,  4,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 4, 11,  3, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([10,  1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 6,  9,  0,  8, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  2,  0,  7, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 12,  5], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  8, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5,  8,  6, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 7-th expert, it's topx is tensor([ 4,  6,  7,  9, 11,  1,  2,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 8, 9, 3, 7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([3, 7, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([12,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6, 11,  1,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 10,  0, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 7,  4,  9, 10, 11, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([2, 5, 8], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 1,  4, 10,  3,  6,  7], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 9, 5, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 2,  3,  4, 10,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([4], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 3-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 9,  8, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 7,  0,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  6, 12], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([1, 3, 9], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  6, 10, 12,  1,  4,  5,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([11,  3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  0,  6, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  9,  8, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 2], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 1, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([1], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  3,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5, 12, 10, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 6,  7,  0,  2,  5,  8,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 9, 1, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1,  5,  6,  7, 12,  8], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 1, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3, 10,  0,  4], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([9, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([2, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8, 2, 5, 7, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 6, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  7, 10,  1,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 4-th expert, it's topx is tensor([12,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  4, 11,  3], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 5, 9, 0, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1, 10, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 2], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2,  5,  6,  7, 12,  3], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 4,  9, 11, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 8, 6], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 7, 3], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([10, 11,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 6, 8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([12,  1,  5,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 1, 11], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 3,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5,  4,  8, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12, 11], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  2,  7,  4, 10], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([ 8,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 9, 10,  0,  3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([3, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([0, 2, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([2, 3, 1, 4, 6, 8], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  5,  7,  8,  2, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  6, 10,  5], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  9, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 4, 11, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  4, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 1,  3, 10, 11,  0,  4,  6], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 3-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([1, 9], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  5,  8,  9, 12,  7], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 5,  8, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([7, 2, 3], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([11,  4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([9, 8], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 3,  4,  6, 11, 12], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 5,  8, 12,  2,  6], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0, 10,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  0,  1,  5,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 1, 12], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 5, 12,  2,  3,  7], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  1,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  4, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 2,  8, 10,  5,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([9, 0, 6, 8], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([6, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([1, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 2,  3,  4, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 6,  0,  7, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([8, 9, 2], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([11,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([0, 3, 8, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 5, 10, 12,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 0,  8,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 2-th expert, it's topx is tensor([ 5,  6,  7,  9, 10,  1,  3,  4,  8, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 1,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([0], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([2], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 6-th expert, it's topx is tensor([12,  6,  7,  9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2,  4, 10], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([0, 1, 2], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7, 10,  3,  5,  9, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0, 12,  8], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([4, 5, 7], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3, 11,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 2,  6,  8,  9, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 0-th expert, it's topx is tensor([ 3,  9,  8, 10, 11, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([10,  5], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([1, 8, 4, 6], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 6,  7, 11,  1], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 12,  2,  9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 4], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([3], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 0-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 1-th expert, it's topx is tensor([ 9, 11,  1,  6, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([1, 3, 7, 2, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  4,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([7, 8], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([4, 5, 6], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 7-th expert, it's topx is tensor([ 2, 12,  0], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([3, 8, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([6, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 4, 11,  1,  3,  6], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 2, 10,  7,  8], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 1,  5,  7, 12,  2], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 0,  5, 11], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0, 10], device='cuda:0'), idx is tensor([1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 9, 12], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([6], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 1-th expert, it's topx is tensor([ 0,  4,  5, 12,  1,  2,  3, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 7,  5, 12], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([9, 7, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([], device='cuda:0', dtype=torch.int64), idx is tensor([], device='cuda:0', dtype=torch.int64)
the 5-th expert, it's topx is tensor([2, 8, 6, 9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  0, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 1,  3, 10,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([2, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 2-th expert, it's topx is tensor([8, 0, 5, 9], device='cuda:0'), idx is tensor([0, 1, 1, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([0, 7], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 4-th expert, it's topx is tensor([6, 4], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 3,  5, 10, 12,  7, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0, 1, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 2, 6], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 8, 10, 12], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([1, 2, 4, 9], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 7,  2,  5,  6, 12], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([6, 1], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 9, 10,  3, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([3, 0, 8], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 8, 10], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([11,  7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  5, 12,  4], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 3,  4,  2,  5, 10, 11], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 1-th expert, it's topx is tensor([12], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 2-th expert, it's topx is tensor([0, 1, 6, 8], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 3-th expert, it's topx is tensor([ 5, 12,  7,  9], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11,  0,  4], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([2, 8, 9, 1, 3], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  6], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([8], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 1-th expert, it's topx is tensor([ 4,  7, 10,  3,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 1, 1, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 8, 11], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 0,  2, 10], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 2,  9,  0,  1,  5, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([ 5, 12,  9], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 6, 4], device='cuda:0'), idx is tensor([0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([3, 7], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 5, 12], device='cuda:0'), idx is tensor([0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([8, 9], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 2-th expert, it's topx is tensor([ 1,  4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  9,  2, 10], device='cuda:0'), idx is tensor([0, 0, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([ 0,  2,  1,  5,  6,  8, 12], device='cuda:0'), idx is tensor([0, 0, 1, 1, 1, 1, 1], device='cuda:0')
the 5-th expert, it's topx is tensor([7], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 6-th expert, it's topx is tensor([ 0,  4, 11], device='cuda:0'), idx is tensor([1, 1, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([10,  3,  7], device='cuda:0'), idx is tensor([0, 1, 1], device='cuda:0')
the 0-th expert, it's topx is tensor([ 4,  6, 11], device='cuda:0'), idx is tensor([0, 0, 0], device='cuda:0')
the 1-th expert, it's topx is tensor([10], device='cuda:0'), idx is tensor([0], device='cuda:0')
the 2-th expert, it's topx is tensor([ 0,  2,  5, 12], device='cuda:0'), idx is tensor([0, 0, 0, 0], device='cuda:0')
the 3-th expert, it's topx is tensor([ 3,  1,  4,  8,  9, 10], device='cuda:0'), idx is tensor([0, 1, 1, 1, 1, 1], device='cuda:0')
the 4-th expert, it's topx is tensor([11], device='cuda:0'), idx is tensor([1], device='cuda:0')
the 5-th expert, it's topx is tensor([7, 3], device='cuda:0'), idx is tensor([0, 1], device='cuda:0')
the 6-th expert, it's topx is tensor([1, 8, 9, 6], device='cuda:0'), idx is tensor([0, 0, 0, 1], device='cuda:0')
the 7-th expert, it's topx is tensor([ 0,  2,  5,  7, 12], device='cuda:0'), idx is tensor([1, 1, 1, 1, 1], device='cuda:0')
[main] MoE层时间(假设): 0.2223s, 总推理: 0.4446s
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.1 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 1) => CPU(w1,w2,w3)
[move_expert_weights_to_device] model.layers.6.block_sparse_moe.experts.0 的 w1/w2/w3 => cpu
[swap_out_expert] Expert(6, 0) => CPU(w1,w2,w3)
[main] 总 swap_in=22, swap_out=24, swap_latency=0.6977s
